

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Regressione: Come Scegliere il modello &#8212; Tecnologie &amp; Software di Data Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Iris Dataset" href="../classification/iris_dataset.html" />
    <link rel="prev" title="Regressione Custom Data" href="regressore_custom_data.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Tecnologie & Software di Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../introduzione_generale.html">Introduzione</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Programming Tools</p>
</li>
  <li class="">
    <a href="../programming/google_colab.html">Google Colaboratory</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Introduzione a Python</p>
</li>
  <li class="">
    <a href="../python/introduzione_programmazione.html">Introduzione programmazione</a>
  </li>
  <li class="">
    <a href="../python/numpy.html">Numpy</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Data Visualization</p>
</li>
  <li class="">
    <a href="../visualization/pandas.html">Pandas</a>
  </li>
  <li class="">
    <a href="../visualization/matplotlib.html">Matplotlib</a>
  </li>
  <li class="">
    <a href="../visualization/seaborn.html">Seaborn</a>
  </li>
  <li class="">
    <a href="../visualization/analisi_covid19_spiegazione.html">Analisi Covid19 dataset usando Pandas, Matplotlib, Plotly, Dash : (Spiegazione)</a>
  </li>
  <li class="">
    <a href="../visualization/analisi_covid19_esercizio.html">Analisi Covid19 dataset usando Pandas, Matplotlib, Plotly, Dash : (Soluzione)</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Regressione</p>
</li>
  <li class="">
    <a href="tips_dataset.html">TIPS Dataset</a>
  </li>
  <li class="">
    <a href="boston_housing_dataset.html">Boston Housing Dataset</a>
  </li>
  <li class="">
    <a href="regressore_custom_data.html">Regressione Custom Data</a>
  </li>
  <li class="active">
    <a href="">Regressione: Come Scegliere il modello</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Classificazione</p>
</li>
  <li class="">
    <a href="../classification/iris_dataset.html">Iris Dataset</a>
  </li>
  <li class="">
    <a href="../classification/binary_classifier.html">Binary classifier 5 or not 5 ?</a>
  </li>
  <li class="">
    <a href="../classification/decision_tree.html">Decision Tree</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Unsupervised</p>
</li>
  <li class="">
    <a href="../unsupervised/clustering.html">Clustering</a>
  </li>
  <li class="">
    <a href="../unsupervised/pca.html">PCA</a>
  </li>
  <li class="">
    <a href="../unsupervised/pca_regressione.html">PCA: Regressione</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">PySpark</p>
</li>
  <li class="">
    <a href="../pyspark/template_pyspark.html">Template</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_dataframe.html">Dataframe</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_dataframe_sql.html">SQL e Dataframe</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_amazon.html">Amazon Ratings Books</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_apple_stock.html">Analisi del prezzo delle Azioni di Apple</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_movies.html">Analisi recensioni film</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_boston.html">Pyspark</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_RDD.html">RDD: Resilient Distributed Dataset</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/docs/regression/regression_choice.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#importare-le-librerie" class="nav-link">Importare le librerie</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#caricare-il-dataset" class="nav-link">1. Caricare il dataset</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#comparare-i-modelli" class="nav-link">2. Comparare i modelli</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#scegliere-il-modello-migliore" class="nav-link">3. Scegliere il modello migliore</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#applicare-il-modello-allenato-a-un-nuovo-set-di-dati" class="nav-link">4. Applicare il modello allenato a un nuovo set di dati</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#extra-train-test-procedure" class="nav-link">Extra: Train-Test procedure</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/visiont3lab/tecnologie_data_science/blob/master/book/docs/regression/regression_choice.ipynb" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="section" id="regressione-come-scegliere-il-modello">
<h1>Regressione: Come Scegliere il modello<a class="headerlink" href="#regressione-come-scegliere-il-modello" title="Permalink to this headline">¶</a></h1>
<p>Questo notebook fornisce un esempio  che permette di comparare il comportamento di diversi regressori e scegliere il migliore. Al fine di fare questa scelta viene utilizzata la cross-validation che permette di capire quanto il regressore è robusto a variazioni nel train-test set.</p>
<ol class="simple">
<li><p>Caricare il dataset (di regressione).</p></li>
<li><p>Comparare i modelli</p></li>
<li><p>Scegliere il modello migliore</p></li>
<li><p>Applicare il modello allenato a un nuovo set di dati</p></li>
</ol>
<div class="section" id="importare-le-librerie">
<h2>Importare le librerie<a class="headerlink" href="#importare-le-librerie" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">linear_model</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span>  <span class="c1"># MSE</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_absolute_error</span> <span class="c1"># MAE</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">median_absolute_error</span> <span class="c1"># MedAE</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">PolynomialFeatures</span>
<span class="kn">from</span> <span class="nn">sklearn.decomposition</span> <span class="kn">import</span> <span class="n">PCA</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">KFold</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">cross_val_score</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">RANSACRegressor</span><span class="p">,</span> <span class="n">SGDRegressor</span><span class="p">,</span> <span class="n">HuberRegressor</span><span class="p">,</span> <span class="n">TheilSenRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span><span class="p">,</span> <span class="n">Ridge</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">ElasticNet</span>
<span class="kn">from</span> <span class="nn">sklearn.tree</span> <span class="kn">import</span> <span class="n">DecisionTreeRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.neighbors</span> <span class="kn">import</span> <span class="n">KNeighborsRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVR</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">AdaBoostRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">GradientBoostingRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">RandomForestRegressor</span>
<span class="kn">from</span> <span class="nn">sklearn.ensemble</span> <span class="kn">import</span> <span class="n">ExtraTreesRegressor</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sn</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">plotly.graph_objects</span> <span class="k">as</span> <span class="nn">go</span>
<span class="kn">import</span> <span class="nn">pickle</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">sklearn.pipeline</span> <span class="kn">import</span> <span class="n">Pipeline</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="caricare-il-dataset">
<h2>1. Caricare il dataset<a class="headerlink" href="#caricare-il-dataset" title="Permalink to this headline">¶</a></h2>
<p>Assumiamo che l’ultima colonna del dataset sia il valore di target e che il dataset contenga come input solo valori numerici.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;boston&quot;</span><span class="p">):</span>
    <span class="n">datasets_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;boston&quot;</span><span class="p">,</span> <span class="s2">&quot;diabetes&quot;</span><span class="p">]</span> <span class="c1">#,&quot;tips&quot;]</span>
    <span class="n">chosen_dataset</span> <span class="o">=</span> <span class="n">name</span> <span class="c1">#&quot;boston&quot;</span>

    <span class="n">boston</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_boston</span><span class="p">()</span>
    <span class="n">df_boston</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">boston</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">boston</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">df_boston</span><span class="p">[</span><span class="s2">&quot;price&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">boston</span><span class="o">.</span><span class="n">target</span>

    <span class="n">diabetes</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_diabetes</span><span class="p">()</span>
    <span class="n">df_diabetes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">diabetes</span><span class="o">.</span><span class="n">data</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">diabetes</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>
    <span class="n">df_diabetes</span><span class="p">[</span><span class="s2">&quot;desease&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">diabetes</span><span class="o">.</span><span class="n">target</span>
    <span class="n">df_diabetes</span> <span class="o">=</span> <span class="n">df_diabetes</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">decimals</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

    <span class="c1">#df_nuovo_dataset = pd.read_csv(&quot;https://docs.google.com/spreadsheets/d/e/2PACX-1vSqHhx2kS9gCNmI04yksqTP2PRsT6ifTU2DLokKs3Y6KgcSGIAL7_4t_q_8kNhVkFA0xD2nt7hn_w-5/pub?output=csv&quot;)</span>

    <span class="n">dict_datasets</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&quot;boston&quot;</span><span class="p">:</span> <span class="n">df_boston</span><span class="p">,</span>
        <span class="s2">&quot;diabetes&quot;</span><span class="p">:</span> <span class="n">df_diabetes</span><span class="p">,</span>
    <span class="c1">#    &quot;nuovo&quot; : df_nuovo_dataset</span>
    <span class="p">}</span>    
    <span class="n">df</span> <span class="o">=</span> <span class="n">dict_datasets</span><span class="p">[</span><span class="n">chosen_dataset</span><span class="p">]</span><span class="c1">#.head(10)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>

    <span class="c1">#print(df.head())</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>  <span class="c1"># Input: dalla prima alla penultima colonna</span>
    <span class="n">Y</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>    <span class="c1"># Target: utlima colonna</span>

    <span class="k">return</span> <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">df</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;boston&quot;</span><span class="p">)</span>
<span class="n">display</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRIM</th>
      <th>ZN</th>
      <th>INDUS</th>
      <th>CHAS</th>
      <th>NOX</th>
      <th>RM</th>
      <th>AGE</th>
      <th>DIS</th>
      <th>RAD</th>
      <th>TAX</th>
      <th>PTRATIO</th>
      <th>B</th>
      <th>LSTAT</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.00632</td>
      <td>18.0</td>
      <td>2.31</td>
      <td>0.0</td>
      <td>0.538</td>
      <td>6.575</td>
      <td>65.2</td>
      <td>4.0900</td>
      <td>1.0</td>
      <td>296.0</td>
      <td>15.3</td>
      <td>396.90</td>
      <td>4.98</td>
      <td>24.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.02731</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>6.421</td>
      <td>78.9</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>396.90</td>
      <td>9.14</td>
      <td>21.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.02729</td>
      <td>0.0</td>
      <td>7.07</td>
      <td>0.0</td>
      <td>0.469</td>
      <td>7.185</td>
      <td>61.1</td>
      <td>4.9671</td>
      <td>2.0</td>
      <td>242.0</td>
      <td>17.8</td>
      <td>392.83</td>
      <td>4.03</td>
      <td>34.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.03237</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>6.998</td>
      <td>45.8</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>394.63</td>
      <td>2.94</td>
      <td>33.4</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.06905</td>
      <td>0.0</td>
      <td>2.18</td>
      <td>0.0</td>
      <td>0.458</td>
      <td>7.147</td>
      <td>54.2</td>
      <td>6.0622</td>
      <td>3.0</td>
      <td>222.0</td>
      <td>18.7</td>
      <td>396.90</td>
      <td>5.33</td>
      <td>36.2</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="comparare-i-modelli">
<h2>2. Comparare i modelli<a class="headerlink" href="#comparare-i-modelli" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">validate</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
    <span class="n">mse</span> <span class="o">=</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">)</span>
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mse</span><span class="p">)</span>
    <span class="n">mae</span> <span class="o">=</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">)</span>
    <span class="n">medae</span> <span class="o">=</span> <span class="n">median_absolute_error</span><span class="p">(</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_pred</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;[&quot;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="s2">&quot;]&quot;</span> <span class="o">+</span> <span class="s2">&quot; MSE: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mse</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;RMSE  : &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">rmse</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;MAE: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">mae</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="s2">&quot;MedAE: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">medae</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">compare_models</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">):</span>
    <span class="c1"># Split data into training and validation set</span>
    <span class="c1">#X_train, X_test, Y_train, Y_test = train_test_split(X, Y, test_size=0.01,  shuffle=True, random_state=0) </span>
    <span class="c1">#print(&quot;Shapes: X_train: &quot;, X_train.shape, &quot;Y_train: &quot;, Y_train.shape, &quot;X_test: &quot;, X_test.shape, &quot;Y_test&quot;, Y_test.shape)</span>
    <span class="c1">#print(&quot;Metric : negative mean square error (MSE)&quot;)</span>

    <span class="c1"># Scaling</span>
    <span class="n">sc</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
    <span class="n">sc</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">X_train</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="n">Y_train</span> <span class="o">=</span> <span class="n">Y</span>
    <span class="c1">#X_test = sc.transform(X_test)</span>

    <span class="c1"># PCA</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    pc = PCA(n_components=0.95)</span>
<span class="sd">    pc.fit(X_train)</span>
<span class="sd">    X_train = pc.transform(X_train)</span>
<span class="sd">    X_test = pc.transform(X_test)</span>
<span class="sd">    print (pc.explained_variance_)</span>
<span class="sd">    print (pc.explained_variance_ratio_)</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c1"># Polinomial degree</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    poly = PolynomialFeatures(degree=2)</span>
<span class="sd">    poly.fit(X_train)</span>
<span class="sd">    X_train = poly.transform(X_train)</span>
<span class="sd">    X_test = poly.transform(X_test)</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="c1"># user variables to tune</span>
    <span class="n">seed</span>    <span class="o">=</span> <span class="mi">5</span>
    <span class="n">folds</span>   <span class="o">=</span> <span class="mi">20</span>
    <span class="n">metric</span>  <span class="o">=</span> <span class="s2">&quot;neg_mean_squared_error&quot;</span>

    <span class="c1"># hold different regression models in a single dictionary</span>
    <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Linear&quot;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
    <span class="c1">#models[&quot;RANSAC&quot;]        = RANSACRegressor()</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Huber&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">HuberRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;TheilSen&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">TheilSenRegressor</span><span class="p">()</span>
    <span class="c1">#models[&quot;SGD&quot;]           = SGDRegressor(max_iter=500,penalty=None, eta0=0.01, tol=0.00001)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Ridge&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Lasso&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;ElasticNet&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">()</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;KNN&quot;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">(</span><span class="n">n_neighbors</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;DecisionTree&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;SVR&quot;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">SVR</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="s2">&quot;auto&quot;</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;AdaBoost&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">AdaBoostRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;GradientBoost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;RandomForest&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="n">models</span><span class="p">[</span><span class="s2">&quot;ExtraTrees&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">ExtraTreesRegressor</span><span class="p">(</span><span class="n">n_estimators</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

    <span class="c1"># 10-fold cross validation for each model</span>
    <span class="n">model_results</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">model_names</span>   <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">model_name</span> <span class="ow">in</span> <span class="n">models</span><span class="p">:</span>
        <span class="n">model</span>   <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">model_name</span><span class="p">]</span>
        <span class="n">k_fold</span>  <span class="o">=</span> <span class="n">KFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">folds</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span><span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">cross_val_score</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">cv</span><span class="o">=</span><span class="n">k_fold</span><span class="p">,</span> <span class="n">scoring</span><span class="o">=</span><span class="n">metric</span><span class="p">)</span>

        <span class="n">model_results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
        <span class="n">model_names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model_name</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">{}</span><span class="s2">: </span><span class="si">{}</span><span class="s2">, </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">mean</span><span class="p">(),</span> <span class="mi">3</span><span class="p">),</span> <span class="nb">round</span><span class="p">(</span><span class="n">results</span><span class="o">.</span><span class="n">std</span><span class="p">(),</span> <span class="mi">3</span><span class="p">)))</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span><span class="p">,</span><span class="n">res</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">model_names</span><span class="p">,</span><span class="n">model_results</span><span class="p">):</span>    
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Box</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">res</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">boxpoints</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">))</span>
    <span class="c1">#fig.show()</span>
    <span class="k">return</span> <span class="n">fig</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig_compare_models</span> <span class="o">=</span> <span class="n">compare_models</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>
<span class="n">fig_compare_models</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Linear: -23.533, 10.945
Huber: -25.031, 14.541
TheilSen: -37.376, 28.403
Ridge: -23.524, 10.984
Lasso: -29.188, 14.094
ElasticNet: -30.867, 16.12
KNN: -20.13, 15.229
DecisionTree: -20.887, 15.888
SVR: -27.564, 19.139
AdaBoost: -13.377, 7.447
GradientBoost: -8.325, 4.687
RandomForest: -10.046, 5.919
ExtraTrees: -9.082, 4.401
</pre></div>
</div>
<div class="output text_html"><div>


            <div id="c20f3d8f-2f07-4660-854f-6642f6a9edad" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                require(["plotly"], function(Plotly) {
                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("c20f3d8f-2f07-4660-854f-6642f6a9edad")) {
                    Plotly.newPlot(
                        'c20f3d8f-2f07-4660-854f-6642f6a9edad',
                        [{"boxpoints": "all", "name": "Linear", "type": "box", "y": [-24.628520127679437, -20.70473687890746, -16.307317591708095, -19.75472149517848, -42.59541683506843, -53.934699021627395, -18.810299177158218, -21.18361208853076, -11.266363246398173, -12.986874694193055, -28.170937082281174, -13.003424352180138, -13.325819770039889, -36.57815075786528, -23.860041405979004, -27.34535156522036, -21.320316838227885, -35.52853908793986, -11.842420427548337, -17.517757455734692]}, {"boxpoints": "all", "name": "Huber", "type": "box", "y": [-25.69809956600875, -16.596486839134005, -19.822121828283095, -19.212947816411507, -56.23631631863555, -64.69561908589033, -24.922447892006197, -25.388571055673818, -11.431280694429608, -12.426758294081644, -22.200748557539136, -11.645475015323957, -10.110937913104626, -40.55100085514964, -26.922671424087593, -22.80439864821577, -19.331003924678477, -41.8569941916173, -12.995584265875689, -15.77353242650251]}, {"boxpoints": "all", "name": "TheilSen", "type": "box", "y": [-30.782313287493476, -19.089439661796636, -26.3541877118736, -53.43929239042815, -62.50519554001194, -142.05327696072067, -35.487313143161934, -45.01373481133282, -14.373257985482983, -22.45319191153648, -32.77345416238755, -11.949870945418422, -16.709322507042096, -46.60465240102617, -33.76925380596806, -25.92187826650372, -19.01816336589196, -65.94973678354707, -20.636709256141067, -22.63133090453787]}, {"boxpoints": "all", "name": "Ridge", "type": "box", "y": [-24.533099310014016, -20.6133200720317, -16.333929384531157, -19.69687087356541, -42.75021380826001, -54.06964116233409, -18.851963522879693, -21.250723918088088, -11.239813912495231, -12.900273076734864, -28.01787822698323, -13.011103571870054, -13.25227771244833, -36.55807034535107, -23.88761672614403, -27.300784163294416, -21.24631621370817, -35.602107553671516, -11.863341474036783, -17.50780424476169]}, {"boxpoints": "all", "name": "Lasso", "type": "box", "y": [-23.84245810066819, -20.303898855196845, -19.83510592765078, -35.52493553122884, -54.23426828982151, -69.70736597044524, -22.912301056018304, -30.83565353091683, -17.66117577749965, -17.528554646545917, -26.668216845729457, -17.634896757811195, -16.152691417671107, -43.13587373877294, -22.08599332521715, -31.90246904886162, -19.559678378770972, -49.04411262061072, -19.31069029482865, -25.878055262531262]}, {"boxpoints": "all", "name": "ElasticNet", "type": "box", "y": [-20.587213591126815, -18.321695146935724, -24.78221714268254, -36.880937334553806, -58.52099550035564, -78.87271547704651, -21.8498974118129, -37.077968431106235, -17.732798186858258, -18.27036239247018, -29.90669364467877, -17.15743587949498, -16.981332035492937, -47.925028238452654, -24.811943621929505, -30.664472983982954, -17.282090622100434, -49.53863588854101, -21.136745559553923, -29.03396850072698]}, {"boxpoints": "all", "name": "KNN", "type": "box", "y": [-12.752646153846152, -8.81669230769231, -17.047800000000002, -29.656569230769232, -23.89064615384615, -62.395507692307696, -9.425056000000001, -27.799376, -9.702784, -8.722304000000006, -31.905583999999994, -9.651648000000009, -12.083727999999999, -49.109264, -8.768687999999996, -11.226847999999997, -11.055423999999995, -40.746064000000004, -5.513471999999999, -12.325136000000008]}, {"boxpoints": "all", "name": "DecisionTree", "type": "box", "y": [-62.52461538461538, -22.51461538461538, -51.442307692307686, -15.259230769230772, -7.188076923076925, -55.27653846153847, -15.1852, -17.18, -9.281600000000003, -8.1452, -12.229199999999997, -13.687199999999995, -11.320800000000002, -9.5692, -23.8216, -11.562400000000004, -16.7092, -27.584800000000005, -17.069999999999997, -10.182400000000003]}, {"boxpoints": "all", "name": "SVR", "type": "box", "y": [-10.88926715164833, -17.94292036188994, -25.2517372001587, -52.704311275679984, -50.227328708262306, -84.6021939980211, -9.536964226794614, -35.74724628191685, -16.69782227398693, -10.012474918344921, -27.795150373826438, -12.428562385271897, -14.434575200781014, -46.83560773711452, -17.764854131695856, -20.866103649006973, -8.912812239191464, -46.85517240895311, -18.674609280835636, -23.105048616691278]}, {"boxpoints": "all", "name": "AdaBoost", "type": "box", "y": [-11.707267955724848, -8.121189597002004, -18.309173002013537, -11.847950520531093, -8.786104709931045, -5.564295093674914, -7.499435952866919, -12.534139513566936, -8.896937431032665, -9.237007924020144, -17.144452686202513, -12.897233021957641, -9.082911993879884, -29.563948797403103, -13.755486617016631, -14.916924850684083, -8.74658026926399, -36.97747192952896, -8.722679390592283, -13.236585952757888]}, {"boxpoints": "all", "name": "GradientBoost", "type": "box", "y": [-16.82713712968209, -6.475081041306817, -5.713604488482821, -4.851780767418922, -7.266107324341372, -6.06455398833432, -8.559559701911617, -5.906874977644901, -4.018916809509186, -4.813373191102902, -6.745496046649248, -8.382201749549596, -6.0295480278014715, -9.003195079046817, -8.094503402890908, -9.003935224789382, -9.36276132822253, -25.295225521622598, -6.428972796437332, -7.6656076683493275]}, {"boxpoints": "all", "name": "RandomForest", "type": "box", "y": [-16.504009653846154, -5.916511153846145, -12.600899576923076, -6.737397499999966, -10.040267153846138, -13.058321692307677, -10.840559319999976, -6.835950320000008, -4.381450320000007, -5.605470280000003, -7.2548366000000035, -9.663680440000038, -12.184689800000017, -7.445625120000008, -9.071200799999984, -6.6561450800000035, -9.702379559999999, -32.44270548, -6.4628078399999955, -7.51306531999998]}, {"boxpoints": "all", "name": "ExtraTrees", "type": "box", "y": [-17.35919903846154, -4.97242926923076, -10.135937307692302, -6.460043115384598, -9.319676384615356, -9.59446676923076, -10.04883943999999, -9.08065395999998, -5.093852600000003, -4.928983640000002, -7.992004239999996, -9.073731200000028, -6.794591280000001, -21.947141400000007, -9.639820879999972, -3.932545879999998, -7.988754920000004, -15.229771559999987, -4.765252759999995, -7.2813567999999815]}],
                        {"template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('c20f3d8f-2f07-4660-854f-6642f6a9edad');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                });
            </script>
        </div></div></div>
</div>
</div>
<div class="section" id="scegliere-il-modello-migliore">
<h2>3. Scegliere il modello migliore<a class="headerlink" href="#scegliere-il-modello-migliore" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_fig</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span> <span class="n">names</span><span class="p">):</span>
    <span class="c1"># Ys list of output to plot [Y_real, Y_pred]</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">Ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">go</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">yh</span><span class="p">,</span><span class="n">nm</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">Ys</span><span class="p">,</span><span class="n">names</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">add_trace</span><span class="p">(</span><span class="n">go</span><span class="o">.</span><span class="n">Scatter</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">yh</span><span class="p">,</span>
                      <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;lines&#39;</span><span class="p">,</span><span class="c1">#mode=&#39;lines+markers&#39;,</span>
                      <span class="n">name</span><span class="o">=</span><span class="n">nm</span><span class="p">))</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">update_layout</span><span class="p">(</span>
      <span class="n">hovermode</span> <span class="o">=</span> <span class="s2">&quot;x&quot;</span><span class="p">,</span>
      <span class="n">paper_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;rgb(0,0,0)&quot;</span> <span class="p">,</span>
      <span class="n">plot_bgcolor</span> <span class="o">=</span> <span class="s2">&quot;rgb(10,10,10)&quot;</span> <span class="p">,</span> 
      <span class="n">title</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
          <span class="n">x</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
          <span class="n">text</span> <span class="o">=</span> <span class="s2">&quot;Risultati&quot;</span><span class="p">,</span>
          <span class="n">font</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span>
              <span class="n">size</span> <span class="o">=</span> <span class="mi">20</span><span class="p">,</span>
              <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;rgb(255,255,255)&quot;</span>
          <span class="p">)</span>
      <span class="p">)</span>
    <span class="p">)</span>
    <span class="k">return</span> <span class="n">fig</span>

<span class="k">def</span> <span class="nf">train</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">selected</span><span class="o">=</span><span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="n">modelName</span><span class="o">=</span><span class="s1">&#39;best_model.sav&#39;</span><span class="p">):</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="o">-</span><span class="mi">10000000</span>
    <span class="n">n_iter</span> <span class="o">=</span> <span class="mi">20</span>
    <span class="n">R2_train_max</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">R2_test_max</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">n_iter</span><span class="p">):</span>
        <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.10</span><span class="p">,</span>  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

        <span class="c1"># Scaling</span>
        <span class="c1">#sc = StandardScaler()</span>
        <span class="c1">#sc.fit(X_train)</span>
        <span class="c1">#X_train = sc.transform(X_train)</span>
        <span class="c1">#X_test = sc.transform(X_test)</span>

        <span class="c1"># create and fit the best regression model</span>
        <span class="n">seed</span> <span class="o">=</span><span class="mi">5</span>
        <span class="n">models</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Linear&quot;</span><span class="p">]</span>        <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span>
        <span class="c1">#models[&quot;RANSAC&quot;]        = RANSACRegressor()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Huber&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">HuberRegressor</span><span class="p">(</span><span class="n">max_iter</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;TheilSen&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">TheilSenRegressor</span><span class="p">()</span>
        <span class="c1">#models[&quot;SGD&quot;]           = SGDRegressor(max_iter=500,penalty=None, eta0=0.01, tol=0.00001)</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Ridge&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Ridge</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;Lasso&quot;</span><span class="p">]</span>         <span class="o">=</span> <span class="n">Lasso</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;ElasticNet&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">ElasticNet</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;KNN&quot;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">KNeighborsRegressor</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;DecisionTree&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">DecisionTreeRegressor</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;SVR&quot;</span><span class="p">]</span>           <span class="o">=</span> <span class="n">SVR</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;AdaBoost&quot;</span><span class="p">]</span>      <span class="o">=</span> <span class="n">AdaBoostRegressor</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;GradientBoost&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">GradientBoostingRegressor</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;RandomForest&quot;</span><span class="p">]</span>  <span class="o">=</span> <span class="n">RandomForestRegressor</span><span class="p">()</span>
        <span class="n">models</span><span class="p">[</span><span class="s2">&quot;ExtraTrees&quot;</span><span class="p">]</span>    <span class="o">=</span> <span class="n">ExtraTreesRegressor</span><span class="p">()</span>
        
        <span class="n">best_model</span> <span class="o">=</span> <span class="n">models</span><span class="p">[</span><span class="n">selected</span><span class="p">]</span>

        <span class="c1"># Logistic Regression</span>
        <span class="n">pipeline</span> <span class="o">=</span> <span class="n">Pipeline</span><span class="p">([</span>
            <span class="p">(</span><span class="s2">&quot;sc&quot;</span><span class="p">,</span> <span class="n">StandardScaler</span><span class="p">()),</span>
            <span class="c1">#(&quot;pca&quot;, PCA(n_components=0.98)),</span>
            <span class="p">(</span><span class="s2">&quot;reg&quot;</span><span class="p">,</span> <span class="n">best_model</span><span class="p">),</span>
        <span class="p">])</span>
        <span class="n">pipeline</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
        
        <span class="c1">#best_model.fit(X_train, Y_train)</span>

        <span class="c1"># make predictions using the model (train and test)</span>
        <span class="n">Y_test_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
        <span class="n">Y_train_pred</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
        <span class="c1">#print(&quot;[INFO] MSE : {}&quot;.format(round(mean_squared_error(Y_test, Y_test_pred), 3)))</span>

        <span class="c1"># R2 score coefficient of determination (quanto gli input influscono sulla predizione)</span>
        <span class="c1"># 0 male 1 bene</span>
        <span class="c1">#validate(Y_train,Y_train_pred,name=&quot;Training&quot;)</span>
        <span class="n">R2_train</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">)</span>
        <span class="c1">#print(&quot;[Training] R2 Score: &quot;, round(R2_train,3))</span>

        <span class="c1">#validate(Y_test,Y_test_pred,name=&quot;Test&quot;)</span>
        <span class="n">R2_test</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">Y_test</span><span class="p">)</span>
        <span class="c1">#print(&quot;[Test] R2 Score: &quot;, round(R2_test,3))</span>

        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R2_test</span><span class="p">)</span><span class="o">&gt;</span><span class="n">max_val</span><span class="p">:</span>
            <span class="c1"># Save model</span>
            <span class="n">R2_train_max</span> <span class="o">=</span> <span class="n">R2_train</span>
            <span class="n">R2_test_max</span> <span class="o">=</span> <span class="n">R2_test</span>
            <span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span><span class="p">))</span>
            <span class="n">max_val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">R2_test</span><span class="p">)</span>
            <span class="n">fig_train</span> <span class="o">=</span> <span class="n">plot_fig</span><span class="p">([</span><span class="n">Y_train</span><span class="p">,</span><span class="n">Y_train_pred</span><span class="p">],[</span><span class="s2">&quot;Train Real&quot;</span><span class="p">,</span> <span class="s2">&quot;Train Predicted&quot;</span><span class="p">])</span>
            <span class="n">fig_test</span> <span class="o">=</span> <span class="n">plot_fig</span><span class="p">([</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_test_pred</span><span class="p">],[</span><span class="s2">&quot;Test Real&quot;</span><span class="p">,</span><span class="s2">&quot;Test Predicted&quot;</span><span class="p">])</span>
    
    <span class="nb">print</span><span class="p">(</span> <span class="s2">&quot;Best: [Training] R2 Score: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">R2_train_max</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best: [Test] R2 Score: &quot;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">R2_test_max</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">fig_train</span><span class="p">,</span><span class="n">fig_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Huber&quot;</span><span class="p">,</span> <span class="s2">&quot;TheilSen&quot;</span><span class="p">,</span><span class="s2">&quot;Ridge&quot;</span><span class="p">,</span><span class="s2">&quot;Lasso&quot;</span><span class="p">,</span><span class="s2">&quot;ElasticNet&quot;</span><span class="p">,</span><span class="s2">&quot;KNN&quot;</span><span class="p">,</span><span class="s2">&quot;DecisionTree&quot;</span><span class="p">,</span><span class="s2">&quot;SVR&quot;</span><span class="p">,</span><span class="s2">&quot;AdaBoost&quot;</span><span class="p">,</span><span class="s2">&quot;GradientBoost&quot;</span><span class="p">,</span><span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span><span class="s2">&quot;ExtraTrees&quot;</span><span class="p">]</span>
<span class="n">chosen_model</span> <span class="o">=</span> <span class="s2">&quot;GradientBoost&quot;</span>
<span class="n">fig_train</span><span class="p">,</span> <span class="n">fig_test</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">selected</span><span class="o">=</span><span class="n">chosen_model</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="s2">&quot;test.sav&quot;</span><span class="p">)</span>
<span class="n">fig_train</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">fig_test</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Best: [Training] R2 Score:  0.976
Best: [Test] R2 Score:  0.965
</pre></div>
</div>
<div class="output text_html"><div>


            <div id="6ad7979e-d40a-413c-bf5a-53a6ba737847" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                require(["plotly"], function(Plotly) {
                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("6ad7979e-d40a-413c-bf5a-53a6ba737847")) {
                    Plotly.newPlot(
                        '6ad7979e-d40a-413c-bf5a-53a6ba737847',
                        [{"mode": "lines", "name": "Train Real", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 455], "y": [19.4, 30.5, 20.5, 16.1, 17.5, 14.9, 19.8, 30.1, 39.8, 22.2, 37.3, 14.3, 33.8, 29.0, 29.0, 21.2, 27.9, 23.1, 20.4, 34.9, 21.7, 48.3, 18.2, 24.8, 21.1, 23.7, 14.4, 8.3, 29.6, 20.1, 22.9, 13.4, 13.1, 22.4, 28.1, 50.0, 19.2, 7.4, 30.1, 26.7, 30.3, 14.3, 13.4, 19.9, 20.0, 32.7, 8.5, 50.0, 29.1, 21.4, 46.7, 28.4, 31.2, 32.0, 16.4, 42.3, 19.5, 8.8, 11.9, 33.1, 9.6, 23.7, 21.9, 22.0, 25.0, 19.4, 22.8, 14.1, 18.5, 17.7, 20.0, 11.9, 21.9, 18.4, 19.3, 28.7, 23.2, 20.8, 22.4, 23.4, 18.9, 33.0, 21.2, 11.7, 20.1, 12.7, 16.0, 43.5, 17.8, 19.6, 15.7, 10.4, 18.8, 28.2, 29.8, 14.4, 32.9, 32.4, 6.3, 35.1, 24.4, 26.6, 18.2, 22.8, 20.6, 34.9, 23.8, 23.7, 43.1, 18.5, 21.0, 16.7, 25.0, 8.4, 15.2, 7.2, 15.4, 8.1, 20.6, 20.1, 14.2, 14.1, 17.8, 26.6, 34.9, 24.4, 19.1, 19.9, 21.5, 19.9, 16.1, 25.2, 35.4, 17.1, 16.8, 16.8, 32.2, 15.3, 17.4, 28.7, 28.4, 31.6, 26.5, 43.8, 13.9, 50.0, 20.1, 17.3, 13.0, 21.7, 12.7, 44.0, 22.5, 19.3, 50.0, 18.3, 19.6, 18.9, 19.0, 18.9, 21.9, 22.3, 27.1, 24.5, 23.8, 18.5, 24.7, 23.9, 20.3, 21.4, 33.1, 23.2, 37.0, 25.3, 19.5, 35.4, 24.1, 21.8, 13.8, 22.0, 7.0, 23.8, 12.3, 17.6, 14.5, 24.0, 15.0, 14.1, 41.7, 36.4, 24.6, 22.5, 13.6, 24.2, 34.6, 41.3, 20.4, 33.2, 10.2, 19.5, 18.7, 8.3, 15.6, 21.0, 14.5, 29.8, 50.0, 50.0, 24.8, 20.5, 50.0, 28.7, 35.2, 17.5, 11.5, 32.0, 12.1, 20.4, 22.0, 17.8, 15.2, 22.6, 16.2, 24.4, 25.1, 16.2, 24.8, 22.6, 13.3, 18.9, 9.5, 23.0, 21.4, 22.3, 11.0, 25.0, 10.2, 22.0, 22.1, 20.3, 21.2, 23.7, 14.5, 22.2, 21.6, 20.6, 21.4, 50.0, 22.8, 30.1, 19.1, 13.1, 22.2, 24.1, 14.9, 19.3, 21.0, 15.0, 23.1, 21.8, 20.8, 16.7, 50.0, 17.5, 23.0, 23.9, 26.6, 19.6, 36.1, 10.9, 7.5, 16.6, 11.7, 19.4, 18.5, 17.2, 36.5, 17.0, 19.7, 25.0, 23.0, 14.6, 23.1, 18.4, 24.5, 36.0, 44.8, 37.9, 24.0, 10.8, 14.9, 18.4, 23.1, 28.0, 7.0, 36.2, 9.7, 18.1, 20.5, 18.3, 50.0, 21.7, 17.1, 22.6, 14.0, 17.9, 22.0, 19.1, 23.6, 12.5, 8.8, 23.8, 21.2, 36.2, 22.2, 37.6, 19.9, 23.1, 8.5, 45.4, 19.3, 11.3, 19.5, 34.7, 30.8, 11.8, 20.6, 31.0, 12.8, 42.8, 18.8, 13.4, 23.3, 17.8, 23.3, 12.7, 17.4, 17.1, 29.9, 24.7, 20.2, 23.4, 13.8, 38.7, 7.2, 28.5, 24.1, 24.3, 20.1, 23.5, 31.6, 23.3, 24.3, 22.6, 17.4, 23.3, 24.6, 24.8, 8.4, 20.3, 13.2, 19.1, 15.1, 13.8, 13.1, 20.9, 16.3, 15.6, 24.5, 23.2, 19.8, 33.4, 24.4, 31.7, 15.6, 18.2, 50.0, 16.5, 22.9, 17.2, 23.9, 24.7, 50.0, 26.2, 33.4, 21.7, 19.8, 15.2, 10.5, 12.6, 18.6, 20.6, 5.0, 20.8, 27.5, 14.6, 30.7, 23.0, 22.7, 31.5, 21.7, 22.0, 23.2, 5.6, 23.9, 21.4, 22.7, 22.8, 28.6, 32.5, 7.2, 25.0, 13.8, 13.3, 27.5, 33.3, 27.1, 14.8, 17.8, 13.6, 22.9, 21.6, 31.5, 21.5, 17.2, 19.3, 11.8, 15.4, 22.6, 13.3, 21.1, 16.5, 13.1, 29.1, 21.7, 50.0, 20.0, 50.0, 20.4, 48.5, 22.5, 16.1, 15.0, 23.1, 19.4, 10.5, 16.6, 15.6, 19.6, 20.9, 20.0, 26.4, 13.9, 22.2, 31.1]}, {"mode": "lines", "name": "Train Predicted", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 433, 434, 435, 436, 437, 438, 439, 440, 441, 442, 443, 444, 445, 446, 447, 448, 449, 450, 451, 452, 453, 455], "y": [18.771359843676326, 29.558715859243154, 20.068767426168197, 17.17546929415029, 17.198217529705623, 13.459565307227873, 20.18743221919132, 31.035955274554208, 40.73572615227856, 22.554705145476305, 35.17693501621821, 15.67862761669292, 34.524629330808224, 26.890030381869483, 30.713359451290057, 21.60173826794106, 28.235017341591362, 22.122998222048743, 19.245175696263658, 33.689859119009895, 20.100902314209925, 45.49722747701893, 18.78264013721954, 26.995613069759614, 20.527294596774542, 23.81322226670297, 13.426927862833445, 9.51248939155665, 28.34419951903186, 20.36218987503713, 23.054087879748522, 14.35564494601274, 15.131560107587646, 22.73111504579295, 25.472335441448397, 48.90905314046928, 19.744769073347634, 8.33532851605904, 31.701476851547174, 29.07707228894959, 30.5319830055274, 14.599615196187758, 13.174337336362786, 20.34619872234629, 20.864619935327593, 32.0186512391811, 8.198661527129557, 48.301903013005074, 26.869447655141084, 21.253103648835253, 44.71324893523987, 27.52263612851823, 30.76160294679717, 33.08600540614391, 15.861588622064682, 43.10077791974335, 19.588254820665174, 8.819932288646736, 14.820157719236787, 32.689249163434376, 11.32292811460754, 24.10509339194226, 22.396947713539284, 20.673381453093132, 23.325618064692343, 19.938740494882172, 26.16856841022771, 14.599615196187758, 17.224484271371534, 18.671292121233204, 20.359705388358098, 12.982993400039883, 23.72431478604009, 18.90814348464642, 20.679078743545755, 26.0091034677954, 20.86418339150052, 19.093745556057666, 21.638461248451485, 22.095011830727707, 17.480026361609035, 32.29656641721972, 21.433366239187126, 12.706760757018532, 19.600728143304096, 13.54081750104866, 16.90912951538694, 46.07053092673098, 16.586788855776952, 19.962854755970728, 16.90739651075188, 11.1091318132702, 18.92259548684871, 29.46562798958974, 30.2872233860884, 16.323367446543116, 33.084681131383824, 31.877624969522405, 8.300740540664002, 34.94457458943837, 23.40989149349852, 28.47652208098518, 19.229579307713394, 23.85744565368711, 19.744187321843626, 34.14793057173227, 23.36126811602068, 21.77705622015811, 42.12122510205695, 18.544558138928906, 21.785654621664023, 17.569111387651247, 22.483643356446088, 9.497221413135117, 15.329806902347809, 10.11538181491592, 14.683721587300457, 9.29792194880447, 20.992818534860035, 20.74857040464044, 15.176267927452257, 15.597504444535293, 16.504976609756113, 26.783439303722986, 34.2369704561368, 23.55971208730623, 18.022538113771375, 20.265025771858102, 21.32335498141682, 19.449586051905975, 18.872241937605857, 24.982370637433075, 36.456347430836765, 15.216609503201749, 17.520162137956618, 19.748567894895782, 31.327518498685237, 18.153344687259946, 20.327687773068558, 30.219029988392183, 26.94660502923888, 32.38862637071686, 25.764420415240757, 43.49201636698442, 14.983176986039751, 48.788695428118864, 18.981638015033184, 17.32924864820408, 14.466162925846145, 21.082689814527022, 14.492869520435528, 43.03490226393318, 20.92735954673089, 20.16759124096264, 48.30899498229548, 20.116710573848838, 20.188361975764675, 18.592067580384708, 17.58526246017664, 20.189099318077297, 18.848838125743274, 22.49369705701802, 20.259778739232495, 21.999598520271213, 22.49369705701802, 21.677792284487012, 22.81799958594224, 22.554165600272146, 20.436045565269787, 22.557261062617496, 31.53549504964575, 23.442060543590006, 33.68977292976233, 24.682670606293186, 17.273609948519255, 34.87112895834161, 24.067924288652755, 20.27292164647374, 15.956731105507835, 23.966072530640638, 9.370677276326132, 22.22560603671067, 11.241065455529966, 18.255105833902924, 14.7706456483209, 25.75702115152814, 16.12066471535756, 15.657410854712738, 42.4364196233012, 36.47546349506416, 24.755647993450932, 20.296112240538353, 14.391616652178538, 23.50710978407904, 33.15591015374185, 40.20669113324687, 21.33931769101904, 34.23539216051802, 11.364051195084791, 19.774937223362073, 18.89817083061327, 8.220864906713352, 15.76045746325874, 20.668125491995426, 14.678737794465244, 27.346922639150996, 49.032421758824796, 48.832948007089335, 24.159577792922242, 19.80418652990485, 47.87214071821845, 27.470378736753116, 38.04099727339191, 19.308041251543585, 11.590795970488635, 28.97066422007418, 11.82409623801439, 20.18743221919132, 22.155116434946724, 16.85464456534955, 16.44199965654729, 20.75824823719457, 19.2326729600235, 24.029254114079247, 25.215234596569267, 15.574839871345814, 26.98842545468771, 22.802816252605307, 13.046432628507734, 20.938489127428994, 9.986776316843024, 23.415466695997377, 20.711394305966966, 22.81167658665083, 10.574013759519724, 24.133466648622388, 11.968121761840763, 22.192486026752714, 23.39471199331875, 21.5928743607591, 20.771998842719558, 24.221662613963577, 18.068357906073242, 21.25405244811705, 21.852802320931048, 20.579762818048685, 20.648884416811374, 48.27709381038311, 23.314404631863614, 26.109525306433035, 21.092807572069873, 14.913976066640627, 23.362681392352, 23.140465437033093, 15.555346569301156, 20.73348948223076, 21.277595929594227, 18.200976716915132, 23.24693731515538, 20.90716928328597, 20.21671371043455, 15.096179515916782, 48.365538013628345, 17.83290351165425, 23.55925266362696, 24.0971481396735, 26.47634650047866, 20.820731324088715, 35.075940367704625, 11.360711292510084, 8.893739675415093, 18.29156612933983, 11.998543567120375, 18.032003929442745, 19.67561602743422, 14.851921856828877, 34.84401187596392, 18.471758257432338, 20.865019264562147, 25.09009232962109, 20.84169304298397, 14.43115609806082, 21.906109948210297, 17.348985610298662, 21.787962522586955, 35.00530470704592, 45.48635076197121, 38.31552897693698, 22.93578207533274, 10.806188540090426, 15.467635662642424, 16.718077733884023, 22.51673384711206, 26.814992211336158, 7.54131459435072, 31.98767663496297, 10.701465533351127, 16.922956975735527, 21.851812183748127, 19.129706389837768, 48.791744770127174, 20.727429379697927, 18.674979792185475, 23.086387151814584, 13.554776159991846, 15.634061431328472, 25.031843873602288, 18.778052297422416, 27.489675688436616, 13.809449253049907, 7.906004081020161, 23.24693731515538, 22.45065531943431, 34.9104977306869, 20.50655358072039, 41.05288246846, 18.54146431714423, 22.921839324300993, 11.051068924976837, 45.42669892290994, 18.90862254698474, 11.241065455529966, 17.273609948519255, 34.19902338990348, 29.032223011939383, 9.936724647903606, 21.298435700517423, 31.543390500980504, 11.45915113815306, 43.44988106681166, 19.34037290272427, 12.566172409128322, 24.971482767329668, 17.89642496350626, 22.87125379533399, 13.244047506105392, 16.288999022282837, 17.907213774255027, 29.867485180000457, 24.77866720702718, 18.9188265840201, 23.50710978407904, 14.390012514585253, 39.37158026757784, 8.140042481770115, 31.580484449267757, 24.429851848833202, 22.686112440857947, 20.18743221919132, 24.984552285122252, 31.310476271287357, 22.516971710969376, 24.584348961975298, 23.565268494033287, 18.87056319624139, 24.168283523909224, 23.731455256442608, 23.42798304837343, 8.677084157160271, 19.55689890239644, 13.6679254448004, 16.286761255694334, 14.484036059736429, 13.070380857343071, 14.374750624599992, 20.56192785245888, 15.673363702449645, 16.746282914496266, 25.194126712646586, 17.733238099130613, 21.185665264773874, 34.077942192226885, 22.517161164600665, 31.868361606203344, 15.99432121397436, 19.47520534827636, 49.47605854794619, 18.86798718405056, 21.683573375048034, 18.34140849277893, 25.56131432540351, 23.562356140823933, 49.226563574288306, 25.874239393389583, 34.086133142089885, 20.117713500042004, 18.863186406241983, 16.048978366322356, 9.635288238642884, 14.429047651859424, 20.462085303837, 21.56443675438051, 6.915613666458497, 21.972831895099887, 25.60579903137701, 16.4807310558306, 29.111590097305143, 21.810547159821784, 21.594154913684793, 33.12309431767762, 20.187154364457406, 22.122040884194192, 22.818674220270122, 6.971713054159713, 24.722025073038875, 22.114824635100835, 21.874486600800488, 22.612987489097616, 27.570639665176394, 31.399140552267635, 8.67447570655527, 28.56990279737737, 14.645667613955213, 13.223154081999539, 24.581086274270724, 33.947693304784956, 26.135742018760276, 15.391202694968213, 14.885408942748994, 13.802044437144385, 23.45355352002377, 22.169448662501747, 31.1517435345071, 20.938538053072683, 17.024482223724885, 20.18743221919132, 13.955208821149425, 14.6038068529531, 22.812996725209278, 15.436303326124655, 20.781358339208357, 16.955793954835165, 11.52588359879374, 29.490741967538177, 20.631334304268425, 49.934703355993285, 21.283530471180203, 47.895129945475986, 20.551215038296796, 48.42514417104583, 23.045048277754983, 17.166706879025273, 16.318242059114073, 20.512742048955158, 20.11424099554574, 9.94189352464757, 17.11555103784055, 15.658545747756753, 18.357010995788507, 20.91406998363483, 18.690536864361647, 25.48469026445596, 12.481669773230085, 23.594511973550553, 29.507318439597743]}],
                        {"hovermode": "x", "paper_bgcolor": "rgb(0,0,0)", "plot_bgcolor": "rgb(10,10,10)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"font": {"color": "rgb(255,255,255)", "size": 20}, "text": "Risultati", "x": 0.5}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('6ad7979e-d40a-413c-bf5a-53a6ba737847');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                });
            </script>
        </div></div><div class="output text_html"><div>


            <div id="e0bae3bc-d99f-45a8-bc3f-73a050dcd8ba" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                require(["plotly"], function(Plotly) {
                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("e0bae3bc-d99f-45a8-bc3f-73a050dcd8ba")) {
                    Plotly.newPlot(
                        'e0bae3bc-d99f-45a8-bc3f-73a050dcd8ba',
                        [{"mode": "lines", "name": "Test Real", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51], "y": [13.5, 27.9, 50.0, 25.0, 20.3, 19.6, 13.4, 13.5, 5.0, 10.4, 18.6, 25.0, 18.7, 26.4, 19.4, 18.7, 25.0, 21.2, 10.9, 29.6, 20.7, 23.6, 10.2, 22.9, 20.7, 19.2, 33.2, 13.8, 15.6, 37.2, 19.4, 29.4, 27.0, 20.6, 23.1, 24.3, 22.0, 27.5, 50.0, 8.7, 12.0, 20.2, 27.5, 18.0, 48.8, 46.0, 23.9, 21.7, 19.7, 20.0, 19.0]}, {"mode": "lines", "name": "Test Predicted", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 51], "y": [14.905164835367717, 27.649826032429818, 48.166986972428624, 23.976189248667065, 21.443914052004658, 19.478452525376504, 11.256423553939008, 15.512828426178208, 6.710849093894437, 8.856347364498323, 17.80046519695186, 23.32404988014326, 20.848446882939495, 23.36937461703796, 19.977354665919016, 19.51369868316448, 26.113392668469476, 20.34699302601012, 11.840518790421754, 34.238848769497366, 22.166561426488556, 23.70929929480423, 9.730840370594214, 21.735842017995218, 23.217539368302038, 21.1266597956291, 32.94110045144318, 15.391882455478898, 14.517415533388561, 35.886893948805394, 18.164666269835024, 28.99614448309798, 24.64066405722257, 21.1164739507745, 19.41965473335179, 21.711442349881093, 24.92817005180345, 26.326000463441414, 48.548780756876184, 8.702337725718046, 13.19473002120541, 20.73950690571017, 24.26066540079394, 17.08593707538883, 46.23692176829304, 45.20332072903309, 27.2188021774683, 22.580994678946272, 16.715392683691064, 17.94625575120137, 20.53822308352383]}],
                        {"hovermode": "x", "paper_bgcolor": "rgb(0,0,0)", "plot_bgcolor": "rgb(10,10,10)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"font": {"color": "rgb(255,255,255)", "size": 20}, "text": "Risultati", "x": 0.5}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('e0bae3bc-d99f-45a8-bc3f-73a050dcd8ba');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                });
            </script>
        </div></div></div>
</div>
</div>
<div class="section" id="applicare-il-modello-allenato-a-un-nuovo-set-di-dati">
<h2>4. Applicare il modello allenato a un nuovo set di dati<a class="headerlink" href="#applicare-il-modello-allenato-a-un-nuovo-set-di-dati" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">apply_model</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="s1">&#39;best_model.sav&#39;</span><span class="p">):</span>
    <span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="n">modelName</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
    <span class="n">y_hat</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">y_hat</span>
</pre></div>
</div>
</div>
</div>
<p>Per questa parte fingeremo di avere nuovi dati. Questi ultimi li creeremo utilizzando la funzione <strong>train_test_split</strong> di scikit-learn.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creiamo dei dati</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.80</span><span class="p">,</span>  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">42</span><span class="o">-</span><span class="mi">2</span><span class="n">d7d3d38ed94</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="n">Y_pred_pipe</span> <span class="o">=</span> <span class="n">apply_model</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="s2">&quot;test.sav&quot;</span><span class="p">)</span>
<span class="ne">----&gt; </span><span class="mi">7</span> <span class="n">fig_res</span> <span class="o">=</span> <span class="n">plot_fig</span><span class="p">([</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span><span class="n">Y_pred_pipe</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">,</span><span class="s2">&quot;pipe&quot;</span><span class="p">])</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span> <span class="n">fig_res</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="ne">NameError</span>: name &#39;Y_pred&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>Carichiamo la pipeline componente per componente per componente</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.sav&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sc_block</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;sc&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">loaded_model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="nb">open</span><span class="p">(</span><span class="s2">&quot;test.sav&quot;</span><span class="p">,</span> <span class="s1">&#39;rb&#39;</span><span class="p">))</span>

<span class="c1"># Applicare lo Standard Scaling</span>
<span class="n">sc_block</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;sc&quot;</span><span class="p">]</span>
<span class="n">X_test_sc</span> <span class="o">=</span> <span class="n">sc_block</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Applicare la PCA</span>
<span class="c1">#pca_block = loaded_model.named_steps[&quot;pca&quot;]</span>
<span class="c1">#X_test_pca = pca_block.transform(X_test_sc)</span>
<span class="c1">#print(pca_block.explained_variance_ratio_)</span>

<span class="c1"># Applicare il regressore</span>
<span class="n">model_trained</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">named_steps</span><span class="p">[</span><span class="s2">&quot;reg&quot;</span><span class="p">]</span>
<span class="n">Y_pred</span> <span class="o">=</span> <span class="n">model_trained</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test_sc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Carichiamo l’intera pipeline</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Y_pred_pipe</span> <span class="o">=</span> <span class="n">apply_model</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="s2">&quot;test.sav&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Assicuriamoci che i due risultati siano uguali</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig_res</span> <span class="o">=</span> <span class="n">plot_fig</span><span class="p">([</span><span class="n">Y_test</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span><span class="n">Y_pred_pipe</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span> <span class="s2">&quot;pred&quot;</span><span class="p">,</span><span class="s2">&quot;pipe&quot;</span><span class="p">])</span>
<span class="n">fig_res</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>


            <div id="b3058ceb-b1db-4a3c-802e-40d62b9ee0a8" class="plotly-graph-div" style="height:525px; width:100%;"></div>
            <script type="text/javascript">
                require(["plotly"], function(Plotly) {
                    window.PLOTLYENV=window.PLOTLYENV || {};

                if (document.getElementById("b3058ceb-b1db-4a3c-802e-40d62b9ee0a8")) {
                    Plotly.newPlot(
                        'b3058ceb-b1db-4a3c-802e-40d62b9ee0a8',
                        [{"mode": "lines", "name": "test", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 405], "y": [32.4, 36.5, 17.3, 20.5, 17.7, 20.8, 24.6, 14.9, 12.7, 28.5, 7.2, 7.0, 29.6, 16.7, 22.8, 21.7, 20.3, 44.8, 21.0, 18.5, 14.6, 17.1, 20.7, 26.2, 13.9, 13.4, 32.9, 21.2, 16.0, 28.0, 25.1, 29.0, 21.4, 8.4, 17.2, 35.4, 20.6, 23.4, 14.9, 25.0, 18.7, 31.1, 26.4, 20.0, 28.2, 13.4, 14.4, 8.1, 5.6, 13.6, 42.3, 8.5, 33.8, 7.2, 15.0, 13.1, 35.1, 21.1, 21.6, 50.0, 20.1, 8.8, 22.8, 48.8, 19.1, 25.0, 13.8, 23.2, 22.5, 13.1, 8.8, 30.8, 45.4, 20.3, 33.4, 11.7, 27.5, 16.7, 22.4, 50.0, 21.2, 24.8, 22.7, 21.4, 36.0, 15.2, 16.1, 19.4, 20.0, 22.2, 30.1, 17.1, 22.0, 19.8, 30.5, 15.6, 20.8, 19.5, 10.5, 24.3, 19.7, 21.4, 19.8, 24.4, 22.6, 37.2, 22.6, 19.6, 5.0, 34.6, 20.4, 21.0, 18.4, 21.2, 12.1, 14.3, 34.7, 19.1, 20.9, 18.5, 16.2, 24.1, 26.4, 23.2, 23.2, 18.4, 32.7, 22.8, 13.3, 29.1, 19.1, 25.0, 22.6, 46.0, 19.3, 19.9, 24.5, 33.0, 11.8, 19.2, 19.9, 22.3, 14.2, 32.2, 50.0, 13.8, 17.4, 27.9, 23.4, 48.3, 14.0, 24.5, 24.7, 15.3, 24.7, 15.2, 29.4, 19.3, 46.7, 37.6, 21.2, 41.7, 16.8, 8.3, 19.4, 24.8, 15.6, 21.4, 21.0, 37.0, 10.9, 38.7, 20.5, 9.6, 19.6, 23.1, 19.6, 31.6, 18.2, 37.9, 13.8, 21.6, 27.5, 7.5, 17.5, 19.2, 20.0, 23.3, 13.4, 50.0, 15.2, 13.8, 18.3, 23.3, 13.3, 24.2, 23.0, 7.0, 18.9, 11.9, 19.6, 27.0, 19.4, 50.0, 17.4, 14.4, 18.9, 25.3, 23.1, 24.1, 21.7, 13.8, 15.6, 31.6, 19.5, 23.1, 8.4, 7.4, 14.5, 23.7, 23.8, 14.6, 14.3, 25.0, 29.1, 19.4, 6.3, 31.5, 13.3, 17.4, 15.0, 13.5, 22.7, 23.9, 11.7, 48.5, 11.3, 16.6, 16.1, 23.5, 23.6, 23.1, 23.8, 23.9, 24.4, 17.5, 11.0, 42.8, 21.9, 20.4, 12.7, 14.9, 36.2, 18.8, 24.8, 27.5, 33.2, 23.0, 16.1, 22.9, 18.5, 23.8, 17.9, 13.0, 20.6, 33.4, 29.0, 19.9, 25.0, 21.7, 10.5, 50.0, 13.1, 20.7, 23.6, 19.6, 24.4, 50.0, 50.0, 30.1, 25.2, 25.0, 34.9, 21.7, 13.2, 28.1, 12.3, 28.7, 22.2, 24.1, 30.1, 22.2, 30.7, 24.0, 22.6, 16.5, 22.0, 22.0, 50.0, 22.0, 50.0, 23.8, 43.5, 29.8, 31.7, 22.3, 24.7, 18.9, 29.8, 23.1, 21.8, 14.8, 19.3, 19.0, 22.8, 50.0, 50.0, 26.5, 20.1, 8.5, 22.0, 17.8, 28.7, 10.9, 14.5, 34.9, 31.0, 31.2, 23.1, 14.1, 23.2, 27.1, 20.3, 14.5, 37.3, 28.4, 9.7, 24.0, 13.5, 15.6, 32.5, 23.7, 50.0, 27.9, 19.1, 17.8, 22.6, 23.9, 27.5, 24.4, 13.9, 17.5, 26.7, 20.0, 17.8, 26.6, 18.2, 17.0, 19.7, 10.8, 13.1, 35.2, 18.9, 10.2, 11.8, 33.1, 19.8, 16.6, 29.6, 8.7, 24.8, 21.7, 20.1, 27.1, 36.1, 36.4, 15.0, 24.5, 18.4, 21.5, 20.2, 22.0, 17.2, 24.6, 12.0, 20.4, 21.9, 50.0, 23.3, 18.6, 50.0, 8.3, 22.2, 23.9, 19.5, 23.3, 12.8, 25.0, 14.1, 21.5, 28.7, 16.4, 20.4, 34.9, 5.0]}, {"mode": "lines", "name": "pred", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 405], "y": [31.877624969522405, 34.84401187596392, 17.32924864820408, 19.80418652990485, 18.671292121233204, 19.093745556057666, 23.731455256442608, 13.459565307227873, 13.244047506105392, 31.580484449267757, 10.11538181491592, 7.54131459435072, 28.34419951903186, 15.096179515916782, 23.85744565368711, 20.187154364457406, 19.55689890239644, 45.48635076197121, 20.668125491995426, 17.224484271371534, 14.43115609806082, 18.674979792185475, 22.166561426488556, 25.874239393389583, 12.481669773230085, 12.566172409128322, 33.084681131383824, 20.771998842719558, 16.90912951538694, 26.814992211336158, 25.215234596569267, 30.713359451290057, 20.711394305966966, 8.677084157160271, 14.851921856828877, 34.87112895834161, 21.1164739507745, 23.50710978407904, 15.467635662642424, 22.483643356446088, 19.51369868316448, 29.507318439597743, 25.48469026445596, 20.864619935327593, 29.46562798958974, 13.174337336362786, 16.323367446543116, 9.29792194880447, 6.971713054159713, 14.391616652178538, 43.10077791974335, 8.198661527129557, 34.524629330808224, 8.67447570655527, 18.200976716915132, 14.374750624599992, 34.94457458943837, 20.527294596774542, 22.169448662501747, 48.301903013005074, 19.600728143304096, 7.906004081020161, 22.612987489097616, 46.23692176829304, 18.778052297422416, 28.56990279737737, 15.391882455478898, 22.818674220270122, 20.92735954673089, 14.913976066640627, 8.819932288646736, 29.032223011939383, 45.42669892290994, 20.436045565269787, 34.086133142089885, 12.706760757018532, 25.60579903137701, 17.569111387651247, 22.73111504579295, 49.47605854794619, 21.60173826794106, 24.159577792922242, 21.594154913684793, 22.114824635100835, 35.00530470704592, 16.048978366322356, 18.872241937605857, 18.164666269835024, 17.94625575120137, 22.554705145476305, 31.701476851547174, 15.216609503201749, 22.192486026752714, 18.863186406241983, 29.558715859243154, 14.517415533388561, 20.21671371043455, 17.273609948519255, 9.635288238642884, 24.584348961975298, 16.715392683691064, 22.557261062617496, 21.185665264773874, 23.55971208730623, 23.086387151814584, 35.886893948805394, 20.75824823719457, 19.962854755970728, 6.915613666458497, 33.15591015374185, 20.18743221919132, 21.277595929594227, 16.718077733884023, 22.45065531943431, 11.82409623801439, 15.67862761669292, 34.19902338990348, 21.092807572069873, 20.91406998363483, 21.677792284487012, 19.2326729600235, 24.429851848833202, 23.36937461703796, 17.733238099130613, 20.86418339150052, 17.348985610298662, 32.0186512391811, 26.16856841022771, 15.436303326124655, 26.869447655141084, 16.286761255694334, 26.113392668469476, 22.812996725209278, 45.20332072903309, 20.679078743545755, 18.54146431714423, 25.194126712646586, 32.29656641721972, 9.936724647903606, 19.744769073347634, 20.34619872234629, 22.49369705701802, 15.176267927452257, 31.327518498685237, 48.365538013628345, 14.645667613955213, 20.327687773068558, 27.649826032429818, 22.095011830727707, 45.49722747701893, 13.554776159991846, 21.787962522586955, 23.562356140823933, 18.153344687259946, 22.81799958594224, 15.329806902347809, 28.99614448309798, 20.73348948223076, 44.71324893523987, 41.05288246846, 21.433366239187126, 42.4364196233012, 17.520162137956618, 8.220864906713352, 20.11424099554574, 26.98842545468771, 15.99432121397436, 21.253103648835253, 21.785654621664023, 33.68977292976233, 11.360711292510084, 39.37158026757784, 20.068767426168197, 11.32292811460754, 20.188361975764675, 19.41965473335179, 20.820731324088715, 32.38862637071686, 19.47520534827636, 38.31552897693698, 14.390012514585253, 21.852802320931048, 24.581086274270724, 8.893739675415093, 17.83290351165425, 21.1266597956291, 20.359705388358098, 24.168283523909224, 11.256423553939008, 47.895129945475986, 16.44199965654729, 13.070380857343071, 20.116710573848838, 22.87125379533399, 13.223154081999539, 23.50710978407904, 21.810547159821784, 9.370677276326132, 18.592067580384708, 14.820157719236787, 19.478452525376504, 24.64066405722257, 18.771359843676326, 48.548780756876184, 18.87056319624139, 13.426927862833445, 20.189099318077297, 24.682670606293186, 21.906109948210297, 23.140465437033093, 20.117713500042004, 15.956731105507835, 15.658545747756753, 31.310476271287357, 19.588254820665174, 20.512742048955158, 9.497221413135117, 8.33532851605904, 14.7706456483209, 23.81322226670297, 22.49369705701802, 16.4807310558306, 14.599615196187758, 23.325618064692343, 29.490741967538177, 19.938740494882172, 8.300740540664002, 31.1517435345071, 13.046432628507734, 16.288999022282837, 16.318242059114073, 14.905164835367717, 21.874486600800488, 25.56131432540351, 11.998543567120375, 48.42514417104583, 11.241065455529966, 17.11555103784055, 17.166706879025273, 24.984552285122252, 23.70929929480423, 22.921839324300993, 22.22560603671067, 24.0971481396735, 22.517161164600665, 17.198217529705623, 10.574013759519724, 43.44988106681166, 22.396947713539284, 21.33931769101904, 13.54081750104866, 15.555346569301156, 34.9104977306869, 19.34037290272427, 26.995613069759614, 26.326000463441414, 34.23539216051802, 23.55925266362696, 17.17546929415029, 23.054087879748522, 19.67561602743422, 23.36126811602068, 15.634061431328472, 14.466162925846145, 21.298435700517423, 34.077942192226885, 26.890030381869483, 20.265025771858102, 23.976189248667065, 20.727429379697927, 9.94189352464757, 48.788695428118864, 15.131560107587646, 23.217539368302038, 27.489675688436616, 18.357010995788507, 23.40989149349852, 48.27709381038311, 48.90905314046928, 26.109525306433035, 24.982370637433075, 24.133466648622388, 33.689859119009895, 20.100902314209925, 13.6679254448004, 25.472335441448397, 11.241065455529966, 30.219029988392183, 20.50655358072039, 24.067924288652755, 31.035955274554208, 21.25405244811705, 29.111590097305143, 25.75702115152814, 23.565268494033287, 16.955793954835165, 22.155116434946724, 24.92817005180345, 48.30899498229548, 25.031843873602288, 49.226563574288306, 23.24693731515538, 46.07053092673098, 27.346922639150996, 31.868361606203344, 22.81167658665083, 24.77866720702718, 20.938489127428994, 30.2872233860884, 22.51673384711206, 20.27292164647374, 15.391202694968213, 20.18743221919132, 20.53822308352383, 23.314404631863614, 49.032421758824796, 47.87214071821845, 25.764420415240757, 20.36218987503713, 11.051068924976837, 22.122040884194192, 16.586788855776952, 27.470378736753116, 11.840518790421754, 14.678737794465244, 34.2369704561368, 31.543390500980504, 30.76160294679717, 22.122998222048743, 15.657410854712738, 23.442060543590006, 26.135742018760276, 21.5928743607591, 18.068357906073242, 35.17693501621821, 27.52263612851823, 10.701465533351127, 22.93578207533274, 15.512828426178208, 15.76045746325874, 31.399140552267635, 24.10509339194226, 49.934703355993285, 28.235017341591362, 18.022538113771375, 16.504976609756113, 22.802816252605307, 24.722025073038875, 24.26066540079394, 24.029254114079247, 14.983176986039751, 19.308041251543585, 29.07707228894959, 21.283530471180203, 16.85464456534955, 26.783439303722986, 19.229579307713394, 18.471758257432338, 20.865019264562147, 10.806188540090426, 11.52588359879374, 38.04099727339191, 17.480026361609035, 11.364051195084791, 13.955208821149425, 31.53549504964575, 20.18743221919132, 18.29156612933983, 34.238848769497366, 8.702337725718046, 23.42798304837343, 22.580994678946272, 20.74857040464044, 20.259778739232495, 35.075940367704625, 36.47546349506416, 16.12066471535756, 21.999598520271213, 18.90814348464642, 20.938538053072683, 20.73950690571017, 20.673381453093132, 18.34140849277893, 24.755647993450932, 13.19473002120541, 20.551215038296796, 18.848838125743274, 48.791744770127174, 24.971482767329668, 20.462085303837, 48.166986972428624, 9.51248939155665, 23.594511973550553, 27.2188021774683, 19.774937223362073, 22.516971710969376, 11.45915113815306, 23.32404988014326, 15.597504444535293, 21.32335498141682, 26.0091034677954, 15.861588622064682, 19.245175696263658, 34.14793057173227, 6.710849093894437]}, {"mode": "lines", "name": "pipe", "type": "scatter", "x": [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 324, 325, 326, 327, 328, 329, 330, 331, 332, 333, 334, 335, 336, 337, 338, 339, 340, 341, 342, 343, 344, 345, 346, 347, 348, 349, 350, 351, 352, 353, 354, 355, 356, 357, 358, 359, 360, 361, 362, 363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 393, 394, 395, 396, 397, 398, 399, 400, 401, 402, 403, 405], "y": [31.877624969522405, 34.84401187596392, 17.32924864820408, 19.80418652990485, 18.671292121233204, 19.093745556057666, 23.731455256442608, 13.459565307227873, 13.244047506105392, 31.580484449267757, 10.11538181491592, 7.54131459435072, 28.34419951903186, 15.096179515916782, 23.85744565368711, 20.187154364457406, 19.55689890239644, 45.48635076197121, 20.668125491995426, 17.224484271371534, 14.43115609806082, 18.674979792185475, 22.166561426488556, 25.874239393389583, 12.481669773230085, 12.566172409128322, 33.084681131383824, 20.771998842719558, 16.90912951538694, 26.814992211336158, 25.215234596569267, 30.713359451290057, 20.711394305966966, 8.677084157160271, 14.851921856828877, 34.87112895834161, 21.1164739507745, 23.50710978407904, 15.467635662642424, 22.483643356446088, 19.51369868316448, 29.507318439597743, 25.48469026445596, 20.864619935327593, 29.46562798958974, 13.174337336362786, 16.323367446543116, 9.29792194880447, 6.971713054159713, 14.391616652178538, 43.10077791974335, 8.198661527129557, 34.524629330808224, 8.67447570655527, 18.200976716915132, 14.374750624599992, 34.94457458943837, 20.527294596774542, 22.169448662501747, 48.301903013005074, 19.600728143304096, 7.906004081020161, 22.612987489097616, 46.23692176829304, 18.778052297422416, 28.56990279737737, 15.391882455478898, 22.818674220270122, 20.92735954673089, 14.913976066640627, 8.819932288646736, 29.032223011939383, 45.42669892290994, 20.436045565269787, 34.086133142089885, 12.706760757018532, 25.60579903137701, 17.569111387651247, 22.73111504579295, 49.47605854794619, 21.60173826794106, 24.159577792922242, 21.594154913684793, 22.114824635100835, 35.00530470704592, 16.048978366322356, 18.872241937605857, 18.164666269835024, 17.94625575120137, 22.554705145476305, 31.701476851547174, 15.216609503201749, 22.192486026752714, 18.863186406241983, 29.558715859243154, 14.517415533388561, 20.21671371043455, 17.273609948519255, 9.635288238642884, 24.584348961975298, 16.715392683691064, 22.557261062617496, 21.185665264773874, 23.55971208730623, 23.086387151814584, 35.886893948805394, 20.75824823719457, 19.962854755970728, 6.915613666458497, 33.15591015374185, 20.18743221919132, 21.277595929594227, 16.718077733884023, 22.45065531943431, 11.82409623801439, 15.67862761669292, 34.19902338990348, 21.092807572069873, 20.91406998363483, 21.677792284487012, 19.2326729600235, 24.429851848833202, 23.36937461703796, 17.733238099130613, 20.86418339150052, 17.348985610298662, 32.0186512391811, 26.16856841022771, 15.436303326124655, 26.869447655141084, 16.286761255694334, 26.113392668469476, 22.812996725209278, 45.20332072903309, 20.679078743545755, 18.54146431714423, 25.194126712646586, 32.29656641721972, 9.936724647903606, 19.744769073347634, 20.34619872234629, 22.49369705701802, 15.176267927452257, 31.327518498685237, 48.365538013628345, 14.645667613955213, 20.327687773068558, 27.649826032429818, 22.095011830727707, 45.49722747701893, 13.554776159991846, 21.787962522586955, 23.562356140823933, 18.153344687259946, 22.81799958594224, 15.329806902347809, 28.99614448309798, 20.73348948223076, 44.71324893523987, 41.05288246846, 21.433366239187126, 42.4364196233012, 17.520162137956618, 8.220864906713352, 20.11424099554574, 26.98842545468771, 15.99432121397436, 21.253103648835253, 21.785654621664023, 33.68977292976233, 11.360711292510084, 39.37158026757784, 20.068767426168197, 11.32292811460754, 20.188361975764675, 19.41965473335179, 20.820731324088715, 32.38862637071686, 19.47520534827636, 38.31552897693698, 14.390012514585253, 21.852802320931048, 24.581086274270724, 8.893739675415093, 17.83290351165425, 21.1266597956291, 20.359705388358098, 24.168283523909224, 11.256423553939008, 47.895129945475986, 16.44199965654729, 13.070380857343071, 20.116710573848838, 22.87125379533399, 13.223154081999539, 23.50710978407904, 21.810547159821784, 9.370677276326132, 18.592067580384708, 14.820157719236787, 19.478452525376504, 24.64066405722257, 18.771359843676326, 48.548780756876184, 18.87056319624139, 13.426927862833445, 20.189099318077297, 24.682670606293186, 21.906109948210297, 23.140465437033093, 20.117713500042004, 15.956731105507835, 15.658545747756753, 31.310476271287357, 19.588254820665174, 20.512742048955158, 9.497221413135117, 8.33532851605904, 14.7706456483209, 23.81322226670297, 22.49369705701802, 16.4807310558306, 14.599615196187758, 23.325618064692343, 29.490741967538177, 19.938740494882172, 8.300740540664002, 31.1517435345071, 13.046432628507734, 16.288999022282837, 16.318242059114073, 14.905164835367717, 21.874486600800488, 25.56131432540351, 11.998543567120375, 48.42514417104583, 11.241065455529966, 17.11555103784055, 17.166706879025273, 24.984552285122252, 23.70929929480423, 22.921839324300993, 22.22560603671067, 24.0971481396735, 22.517161164600665, 17.198217529705623, 10.574013759519724, 43.44988106681166, 22.396947713539284, 21.33931769101904, 13.54081750104866, 15.555346569301156, 34.9104977306869, 19.34037290272427, 26.995613069759614, 26.326000463441414, 34.23539216051802, 23.55925266362696, 17.17546929415029, 23.054087879748522, 19.67561602743422, 23.36126811602068, 15.634061431328472, 14.466162925846145, 21.298435700517423, 34.077942192226885, 26.890030381869483, 20.265025771858102, 23.976189248667065, 20.727429379697927, 9.94189352464757, 48.788695428118864, 15.131560107587646, 23.217539368302038, 27.489675688436616, 18.357010995788507, 23.40989149349852, 48.27709381038311, 48.90905314046928, 26.109525306433035, 24.982370637433075, 24.133466648622388, 33.689859119009895, 20.100902314209925, 13.6679254448004, 25.472335441448397, 11.241065455529966, 30.219029988392183, 20.50655358072039, 24.067924288652755, 31.035955274554208, 21.25405244811705, 29.111590097305143, 25.75702115152814, 23.565268494033287, 16.955793954835165, 22.155116434946724, 24.92817005180345, 48.30899498229548, 25.031843873602288, 49.226563574288306, 23.24693731515538, 46.07053092673098, 27.346922639150996, 31.868361606203344, 22.81167658665083, 24.77866720702718, 20.938489127428994, 30.2872233860884, 22.51673384711206, 20.27292164647374, 15.391202694968213, 20.18743221919132, 20.53822308352383, 23.314404631863614, 49.032421758824796, 47.87214071821845, 25.764420415240757, 20.36218987503713, 11.051068924976837, 22.122040884194192, 16.586788855776952, 27.470378736753116, 11.840518790421754, 14.678737794465244, 34.2369704561368, 31.543390500980504, 30.76160294679717, 22.122998222048743, 15.657410854712738, 23.442060543590006, 26.135742018760276, 21.5928743607591, 18.068357906073242, 35.17693501621821, 27.52263612851823, 10.701465533351127, 22.93578207533274, 15.512828426178208, 15.76045746325874, 31.399140552267635, 24.10509339194226, 49.934703355993285, 28.235017341591362, 18.022538113771375, 16.504976609756113, 22.802816252605307, 24.722025073038875, 24.26066540079394, 24.029254114079247, 14.983176986039751, 19.308041251543585, 29.07707228894959, 21.283530471180203, 16.85464456534955, 26.783439303722986, 19.229579307713394, 18.471758257432338, 20.865019264562147, 10.806188540090426, 11.52588359879374, 38.04099727339191, 17.480026361609035, 11.364051195084791, 13.955208821149425, 31.53549504964575, 20.18743221919132, 18.29156612933983, 34.238848769497366, 8.702337725718046, 23.42798304837343, 22.580994678946272, 20.74857040464044, 20.259778739232495, 35.075940367704625, 36.47546349506416, 16.12066471535756, 21.999598520271213, 18.90814348464642, 20.938538053072683, 20.73950690571017, 20.673381453093132, 18.34140849277893, 24.755647993450932, 13.19473002120541, 20.551215038296796, 18.848838125743274, 48.791744770127174, 24.971482767329668, 20.462085303837, 48.166986972428624, 9.51248939155665, 23.594511973550553, 27.2188021774683, 19.774937223362073, 22.516971710969376, 11.45915113815306, 23.32404988014326, 15.597504444535293, 21.32335498141682, 26.0091034677954, 15.861588622064682, 19.245175696263658, 34.14793057173227, 6.710849093894437]}],
                        {"hovermode": "x", "paper_bgcolor": "rgb(0,0,0)", "plot_bgcolor": "rgb(10,10,10)", "template": {"data": {"bar": [{"error_x": {"color": "#2a3f5f"}, "error_y": {"color": "#2a3f5f"}, "marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "bar"}], "barpolar": [{"marker": {"line": {"color": "#E5ECF6", "width": 0.5}}, "type": "barpolar"}], "carpet": [{"aaxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "baxis": {"endlinecolor": "#2a3f5f", "gridcolor": "white", "linecolor": "white", "minorgridcolor": "white", "startlinecolor": "#2a3f5f"}, "type": "carpet"}], "choropleth": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "choropleth"}], "contour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "contour"}], "contourcarpet": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "contourcarpet"}], "heatmap": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmap"}], "heatmapgl": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "heatmapgl"}], "histogram": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "histogram"}], "histogram2d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2d"}], "histogram2dcontour": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "histogram2dcontour"}], "mesh3d": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "type": "mesh3d"}], "parcoords": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "parcoords"}], "pie": [{"automargin": true, "type": "pie"}], "scatter": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter"}], "scatter3d": [{"line": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatter3d"}], "scattercarpet": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattercarpet"}], "scattergeo": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergeo"}], "scattergl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattergl"}], "scattermapbox": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scattermapbox"}], "scatterpolar": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolar"}], "scatterpolargl": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterpolargl"}], "scatterternary": [{"marker": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "type": "scatterternary"}], "surface": [{"colorbar": {"outlinewidth": 0, "ticks": ""}, "colorscale": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "type": "surface"}], "table": [{"cells": {"fill": {"color": "#EBF0F8"}, "line": {"color": "white"}}, "header": {"fill": {"color": "#C8D4E3"}, "line": {"color": "white"}}, "type": "table"}]}, "layout": {"annotationdefaults": {"arrowcolor": "#2a3f5f", "arrowhead": 0, "arrowwidth": 1}, "coloraxis": {"colorbar": {"outlinewidth": 0, "ticks": ""}}, "colorscale": {"diverging": [[0, "#8e0152"], [0.1, "#c51b7d"], [0.2, "#de77ae"], [0.3, "#f1b6da"], [0.4, "#fde0ef"], [0.5, "#f7f7f7"], [0.6, "#e6f5d0"], [0.7, "#b8e186"], [0.8, "#7fbc41"], [0.9, "#4d9221"], [1, "#276419"]], "sequential": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]], "sequentialminus": [[0.0, "#0d0887"], [0.1111111111111111, "#46039f"], [0.2222222222222222, "#7201a8"], [0.3333333333333333, "#9c179e"], [0.4444444444444444, "#bd3786"], [0.5555555555555556, "#d8576b"], [0.6666666666666666, "#ed7953"], [0.7777777777777778, "#fb9f3a"], [0.8888888888888888, "#fdca26"], [1.0, "#f0f921"]]}, "colorway": ["#636efa", "#EF553B", "#00cc96", "#ab63fa", "#FFA15A", "#19d3f3", "#FF6692", "#B6E880", "#FF97FF", "#FECB52"], "font": {"color": "#2a3f5f"}, "geo": {"bgcolor": "white", "lakecolor": "white", "landcolor": "#E5ECF6", "showlakes": true, "showland": true, "subunitcolor": "white"}, "hoverlabel": {"align": "left"}, "hovermode": "closest", "mapbox": {"style": "light"}, "paper_bgcolor": "white", "plot_bgcolor": "#E5ECF6", "polar": {"angularaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "radialaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "scene": {"xaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "yaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}, "zaxis": {"backgroundcolor": "#E5ECF6", "gridcolor": "white", "gridwidth": 2, "linecolor": "white", "showbackground": true, "ticks": "", "zerolinecolor": "white"}}, "shapedefaults": {"line": {"color": "#2a3f5f"}}, "ternary": {"aaxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "baxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}, "bgcolor": "#E5ECF6", "caxis": {"gridcolor": "white", "linecolor": "white", "ticks": ""}}, "title": {"x": 0.05}, "xaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}, "yaxis": {"automargin": true, "gridcolor": "white", "linecolor": "white", "ticks": "", "title": {"standoff": 15}, "zerolinecolor": "white", "zerolinewidth": 2}}}, "title": {"font": {"color": "rgb(255,255,255)", "size": 20}, "text": "Risultati", "x": 0.5}},
                        {"responsive": true}
                    ).then(function(){

var gd = document.getElementById('b3058ceb-b1db-4a3c-802e-40d62b9ee0a8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })
                };
                });
            </script>
        </div></div></div>
</div>
</div>
<div class="section" id="extra-train-test-procedure">
<h2>Extra: Train-Test procedure<a class="headerlink" href="#extra-train-test-procedure" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Procedura di training</span>
<span class="k">def</span> <span class="nf">train_procedure</span><span class="p">():</span>
    <span class="c1"># 0 CARICA DATASET</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CARICA DATASET&quot;</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">df</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;boston&quot;</span><span class="p">)</span>

    <span class="c1"># 1 COMPARA I MODELLI</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;COMPARA MODELLI&quot;</span><span class="p">)</span>
    <span class="n">fig_compare_models</span> <span class="o">=</span> <span class="n">compare_models</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">)</span>

    <span class="c1"># 2 SCELGO IL MODELLO MIGLIORE</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SCELGO MODELLO MIGLIORE&quot;</span><span class="p">)</span>
    <span class="n">model_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Linear&quot;</span><span class="p">,</span> <span class="s2">&quot;Huber&quot;</span><span class="p">,</span> <span class="s2">&quot;TheilSen&quot;</span><span class="p">,</span><span class="s2">&quot;Ridge&quot;</span><span class="p">,</span><span class="s2">&quot;Lasso&quot;</span><span class="p">,</span><span class="s2">&quot;ElasticNet&quot;</span><span class="p">,</span><span class="s2">&quot;KNN&quot;</span><span class="p">,</span><span class="s2">&quot;DecisionTree&quot;</span><span class="p">,</span><span class="s2">&quot;SVR&quot;</span><span class="p">,</span><span class="s2">&quot;AdaBoost&quot;</span><span class="p">,</span><span class="s2">&quot;GradientBoost&quot;</span><span class="p">,</span><span class="s2">&quot;RandomForest&quot;</span><span class="p">,</span><span class="s2">&quot;ExtraTrees&quot;</span><span class="p">]</span>
    <span class="n">chosen_model</span> <span class="o">=</span> <span class="s2">&quot;GradientBoost&quot;</span>
    <span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;test.sav&quot;</span>
    <span class="n">fig_train</span><span class="p">,</span> <span class="n">fig_test</span> <span class="o">=</span> <span class="n">train</span><span class="p">(</span><span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">selected</span><span class="o">=</span><span class="n">chosen_model</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="n">model_name</span><span class="p">)</span>

<span class="c1"># Procedura di test</span>
<span class="k">def</span> <span class="nf">test_procedure</span><span class="p">():</span>
    <span class="c1"># 3 CARICO IL NUOVO DATASET</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CARICO NUOVO DATASET&quot;</span><span class="p">)</span>
    <span class="n">X</span><span class="p">,</span><span class="n">Y</span><span class="p">,</span><span class="n">df</span> <span class="o">=</span> <span class="n">load_dataset</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;boston&quot;</span><span class="p">)</span>
    <span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">Y_train</span><span class="p">,</span> <span class="n">Y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.80</span><span class="p">,</span>  <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> 

    <span class="c1"># 3bis. APPLICARE IL MODELL ALLENATO</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;APPLICO MODELLO ALLENATO&quot;</span><span class="p">)</span>
    <span class="n">Y_pred_pipe</span> <span class="o">=</span> <span class="n">apply_model</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">modelName</span><span class="o">=</span><span class="s2">&quot;test.sav&quot;</span><span class="p">)</span>
    <span class="n">fig_res</span> <span class="o">=</span> <span class="n">plot_fig</span><span class="p">([</span><span class="n">Y_test</span><span class="p">,</span><span class="n">Y_pred_pipe</span><span class="p">],</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">,</span><span class="s2">&quot;pipe&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#train_procedure()</span>
<span class="n">test_procedure</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="regressore_custom_data.html" title="previous page">Regressione Custom Data</a>
    <a class='right-next' id="next-link" href="../classification/iris_dataset.html" title="next page">Iris Dataset</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Manuel Rucci / Daniele Grotti<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>