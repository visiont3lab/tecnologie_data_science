

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Regressione Custom Data &#8212; Tecnologie &amp; Software di Data Science</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.18.0/dist/embed-amd.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Regressione: Come Scegliere il modello" href="regression_choice.html" />
    <link rel="prev" title="Boston Housing Dataset" href="boston_housing_dataset.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Tecnologie & Software di Data Science</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../introduzione_generale.html">Introduzione</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Programming Tools</p>
</li>
  <li class="">
    <a href="../programming/google_colab.html">Google Colaboratory</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Introduzione a Python</p>
</li>
  <li class="">
    <a href="../python/introduzione_programmazione.html">Introduzione programmazione</a>
  </li>
  <li class="">
    <a href="../python/numpy.html">Numpy</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Data Visualization</p>
</li>
  <li class="">
    <a href="../visualization/pandas.html">Pandas</a>
  </li>
  <li class="">
    <a href="../visualization/matplotlib.html">Matplotlib</a>
  </li>
  <li class="">
    <a href="../visualization/seaborn.html">Seaborn</a>
  </li>
  <li class="">
    <a href="../visualization/analisi_covid19_spiegazione.html">Analisi Covid19 dataset usando Pandas, Matplotlib, Plotly, Dash : (Spiegazione)</a>
  </li>
  <li class="">
    <a href="../visualization/analisi_covid19_esercizio.html">Analisi Covid19 dataset usando Pandas, Matplotlib, Plotly, Dash : (Soluzione)</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Regressione</p>
</li>
  <li class="">
    <a href="tips_dataset.html">TIPS Dataset</a>
  </li>
  <li class="">
    <a href="boston_housing_dataset.html">Boston Housing Dataset</a>
  </li>
  <li class="active">
    <a href="">Regressione Custom Data</a>
  </li>
  <li class="">
    <a href="regression_choice.html">Regressione: Come Scegliere il modello</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Classificazione</p>
</li>
  <li class="">
    <a href="../classification/iris_dataset.html">Iris Dataset</a>
  </li>
  <li class="">
    <a href="../classification/binary_classifier.html">Binary classifier 5 or not 5 ?</a>
  </li>
  <li class="">
    <a href="../classification/decision_tree.html">Decision Tree</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Unsupervised</p>
</li>
  <li class="">
    <a href="../unsupervised/clustering.html">Clustering</a>
  </li>
  <li class="">
    <a href="../unsupervised/pca.html">PCA</a>
  </li>
  <li class="">
    <a href="../unsupervised/pca_regressione.html">PCA: Regressione</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">PySpark</p>
</li>
  <li class="">
    <a href="../pyspark/template_pyspark.html">Template</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_dataframe.html">Dataframe</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_dataframe_sql.html">SQL e Dataframe</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_amazon.html">Amazon Ratings Books</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_apple_stock.html">Analisi del prezzo delle Azioni di Apple</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_movies.html">Analisi recensioni film</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_boston.html">Pyspark</a>
  </li>
  <li class="">
    <a href="../pyspark/pyspark_RDD.html">RDD: Resilient Distributed Dataset</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    
    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../../_sources/docs/regression/regressore_custom_data.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
    
</div>
        <!-- Source interaction buttons -->


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#export-coeff-of-regressor" class="nav-link">Export coeff of regressor</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#export-prediction-in-a-final-column" class="nav-link">Export Prediction in a final column</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#export-model" class="nav-link">Export model</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#import-the-model-pickle-with-new-data" class="nav-link">Import the model (pickle) with new data</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#reduce-number-of-regressor-8-regressors" class="nav-link">Reduce number of regressor 8 regressors</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <p><a href="https://colab.research.google.com/github/visiont3lab/tecnologie_data_science/blob/master/book/docs/regression/regressore_custom_data.ipynb
" target="_parent"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="Open In Colab"/></a></p>
<div class="section" id="regressione-custom-data">
<h1>Regressione Custom Data<a class="headerlink" href="#regressione-custom-data" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<span class="n">uploaded</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>!ls
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>dati.xlsx  drive  sample_data
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;dati.xlsx&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var1</th>
      <th>var2</th>
      <th>var6</th>
      <th>var7</th>
      <th>var8</th>
      <th>var9</th>
      <th>var10</th>
      <th>var11</th>
      <th>var12</th>
      <th>var13</th>
      <th>var14</th>
      <th>var15</th>
      <th>var16</th>
      <th>var17</th>
      <th>var18</th>
      <th>var19</th>
      <th>var20</th>
      <th>var21</th>
      <th>var22</th>
      <th>var23</th>
      <th>var27</th>
      <th>var28</th>
      <th>var29</th>
      <th>var30</th>
      <th>var31</th>
      <th>var32</th>
      <th>var33</th>
      <th>var34</th>
      <th>var35</th>
      <th>var39</th>
      <th>var40</th>
      <th>var41</th>
      <th>var42</th>
      <th>var43</th>
      <th>var44</th>
      <th>var45</th>
      <th>var46</th>
      <th>var47</th>
      <th>var48</th>
      <th>var49</th>
      <th>...</th>
      <th>var108</th>
      <th>var109</th>
      <th>var110</th>
      <th>var111</th>
      <th>var112</th>
      <th>var113</th>
      <th>var114</th>
      <th>var115</th>
      <th>var116</th>
      <th>var123</th>
      <th>var124</th>
      <th>var125</th>
      <th>var126</th>
      <th>var127</th>
      <th>var128</th>
      <th>var129</th>
      <th>var130</th>
      <th>var131</th>
      <th>var132</th>
      <th>var133</th>
      <th>var134</th>
      <th>var135</th>
      <th>var136</th>
      <th>var137</th>
      <th>var141</th>
      <th>var142</th>
      <th>var143</th>
      <th>var147</th>
      <th>var148</th>
      <th>var149</th>
      <th>var150</th>
      <th>var151</th>
      <th>var152</th>
      <th>var153</th>
      <th>var154</th>
      <th>var155</th>
      <th>var156</th>
      <th>var157</th>
      <th>var158</th>
      <th>costi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147823139</td>
      <td>148193655</td>
      <td>51344312</td>
      <td>61401789</td>
      <td>71387976</td>
      <td>23064675</td>
      <td>20882011</td>
      <td>14244395</td>
      <td>2794279</td>
      <td>2677799</td>
      <td>2833077</td>
      <td>14562964</td>
      <td>14352577</td>
      <td>8073273</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>73273</td>
      <td>9312470</td>
      <td>7915379</td>
      <td>7272270</td>
      <td>35436524</td>
      <td>37191289</td>
      <td>32749686</td>
      <td>32719851</td>
      <td>34723462</td>
      <td>30111298</td>
      <td>84978</td>
      <td>318158</td>
      <td>318158</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>7834908</td>
      <td>2178851</td>
      <td>18788146</td>
      <td>290899</td>
      <td>188430</td>
      <td>...</td>
      <td>13310780</td>
      <td>13264428</td>
      <td>12114005</td>
      <td>14296757</td>
      <td>13558421</td>
      <td>13421133</td>
      <td>-823170</td>
      <td>-507756</td>
      <td>-530593</td>
      <td>1228034</td>
      <td>977093</td>
      <td>1122097</td>
      <td>783131</td>
      <td>572136</td>
      <td>267603</td>
      <td>1588604</td>
      <td>1604455</td>
      <td>1856974</td>
      <td>36310</td>
      <td>-66672</td>
      <td>135970</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1870101</td>
      <td>3257494</td>
      <td>4594656</td>
      <td>-3027241</td>
      <td>1534078</td>
      <td>3813249</td>
      <td>229</td>
      <td>214</td>
      <td>207</td>
      <td>84978</td>
      <td>318158</td>
      <td>318158</td>
      <td>25290616</td>
      <td>24108358</td>
      <td>24535319</td>
      <td>144205134</td>
    </tr>
    <tr>
      <th>1</th>
      <td>147562322</td>
      <td>163251010</td>
      <td>1037776</td>
      <td>1391301</td>
      <td>1602930</td>
      <td>23503659</td>
      <td>22973259</td>
      <td>20946238</td>
      <td>13368527</td>
      <td>12404318</td>
      <td>11085331</td>
      <td>1850794</td>
      <td>1693511</td>
      <td>1060485</td>
      <td>364872</td>
      <td>1287356</td>
      <td>811956</td>
      <td>1485922</td>
      <td>406155</td>
      <td>248529</td>
      <td>34529004</td>
      <td>35683884</td>
      <td>35340902</td>
      <td>23391321</td>
      <td>22915530</td>
      <td>18886264</td>
      <td>10795833</td>
      <td>11017483</td>
      <td>11177585</td>
      <td>1583</td>
      <td>1583</td>
      <td>1588</td>
      <td>355977</td>
      <td>43180</td>
      <td>471450</td>
      <td>5293624</td>
      <td>2889766</td>
      <td>1616895</td>
      <td>408806</td>
      <td>551290</td>
      <td>...</td>
      <td>16889643</td>
      <td>15833127</td>
      <td>15986500</td>
      <td>2713441</td>
      <td>2434423</td>
      <td>2180861</td>
      <td>3207072</td>
      <td>1304536</td>
      <td>-3015558</td>
      <td>912728</td>
      <td>1042592</td>
      <td>1058524</td>
      <td>80006</td>
      <td>47390</td>
      <td>35171</td>
      <td>769967</td>
      <td>895916</td>
      <td>1201286</td>
      <td>11943</td>
      <td>82820</td>
      <td>1553908</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1373420</td>
      <td>1220932</td>
      <td>1304576</td>
      <td>1924469</td>
      <td>2124721</td>
      <td>2204557</td>
      <td>454</td>
      <td>411</td>
      <td>456</td>
      <td>1583</td>
      <td>1583</td>
      <td>1588</td>
      <td>14133394</td>
      <td>10404117</td>
      <td>12898505</td>
      <td>140165127</td>
    </tr>
    <tr>
      <th>2</th>
      <td>147562000</td>
      <td>142652000</td>
      <td>737000</td>
      <td>707000</td>
      <td>745000</td>
      <td>51250000</td>
      <td>51604000</td>
      <td>50992000</td>
      <td>23900000</td>
      <td>25404000</td>
      <td>26269000</td>
      <td>69000</td>
      <td>66000</td>
      <td>56000</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>17498000</td>
      <td>12270000</td>
      <td>12954000</td>
      <td>31359000</td>
      <td>47731000</td>
      <td>43044000</td>
      <td>26022000</td>
      <td>43298000</td>
      <td>39653000</td>
      <td>1801000</td>
      <td>1761000</td>
      <td>1171000</td>
      <td>3000</td>
      <td>3000</td>
      <td>0</td>
      <td>19082000</td>
      <td>4224000</td>
      <td>5958000</td>
      <td>1596000</td>
      <td>7000</td>
      <td>...</td>
      <td>9901000</td>
      <td>10029000</td>
      <td>9581000</td>
      <td>3832000</td>
      <td>3762000</td>
      <td>3497000</td>
      <td>-6933000</td>
      <td>683000</td>
      <td>2125000</td>
      <td>2624000</td>
      <td>2743000</td>
      <td>1937000</td>
      <td>53000</td>
      <td>59000</td>
      <td>59000</td>
      <td>915000</td>
      <td>1122000</td>
      <td>1153000</td>
      <td>-1000</td>
      <td>3000</td>
      <td>-10000</td>
      <td>0</td>
      <td>0</td>
      <td>-36000</td>
      <td>9000</td>
      <td>1166000</td>
      <td>1450000</td>
      <td>-803000</td>
      <td>3170000</td>
      <td>2408000</td>
      <td>116</td>
      <td>165</td>
      <td>168</td>
      <td>1801000</td>
      <td>1761000</td>
      <td>1171000</td>
      <td>31861000</td>
      <td>22494000</td>
      <td>24687000</td>
      <td>145190000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>147067625</td>
      <td>140160124</td>
      <td>39316</td>
      <td>5715</td>
      <td>8015</td>
      <td>5258584</td>
      <td>5491288</td>
      <td>5735791</td>
      <td>4183889</td>
      <td>4354175</td>
      <td>4510666</td>
      <td>25917</td>
      <td>25917</td>
      <td>25917</td>
      <td>25917</td>
      <td>25917</td>
      <td>25917</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>25923161</td>
      <td>17921979</td>
      <td>19627665</td>
      <td>21948953</td>
      <td>22868722</td>
      <td>23881755</td>
      <td>15584991</td>
      <td>15576621</td>
      <td>23831452</td>
      <td>890646</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>2226616</td>
      <td>0</td>
      <td>185206</td>
      <td>54173</td>
      <td>1151195</td>
      <td>643650</td>
      <td>567191</td>
      <td>...</td>
      <td>3075383</td>
      <td>3296773</td>
      <td>3290801</td>
      <td>631775</td>
      <td>638706</td>
      <td>725484</td>
      <td>-1868447</td>
      <td>-306450</td>
      <td>3770484</td>
      <td>421274</td>
      <td>885471</td>
      <td>377168</td>
      <td>217482</td>
      <td>149383</td>
      <td>155720</td>
      <td>428722</td>
      <td>439358</td>
      <td>525316</td>
      <td>34150</td>
      <td>95776</td>
      <td>-114667</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>80381</td>
      <td>185005</td>
      <td>258220</td>
      <td>478455</td>
      <td>494325</td>
      <td>473999</td>
      <td>60</td>
      <td>60</td>
      <td>65</td>
      <td>890646</td>
      <td>0</td>
      <td>0</td>
      <td>1000000</td>
      <td>0</td>
      <td>1188439</td>
      <td>112760368</td>
    </tr>
    <tr>
      <th>4</th>
      <td>145273739</td>
      <td>127413305</td>
      <td>6571906</td>
      <td>3613836</td>
      <td>3218188</td>
      <td>65670888</td>
      <td>56917531</td>
      <td>51856050</td>
      <td>20251827</td>
      <td>20965972</td>
      <td>20661743</td>
      <td>2324116</td>
      <td>2070401</td>
      <td>179562</td>
      <td>1754388</td>
      <td>1625505</td>
      <td>178366</td>
      <td>0</td>
      <td>1196</td>
      <td>1196</td>
      <td>18950865</td>
      <td>16878270</td>
      <td>18797216</td>
      <td>8362491</td>
      <td>16303624</td>
      <td>14624193</td>
      <td>4425910</td>
      <td>11432236</td>
      <td>11013435</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>14381920</td>
      <td>10465984</td>
      <td>10529721</td>
      <td>1463431</td>
      <td>707312</td>
      <td>...</td>
      <td>6335628</td>
      <td>5294076</td>
      <td>4974163</td>
      <td>5310610</td>
      <td>4361914</td>
      <td>3345706</td>
      <td>-2235901</td>
      <td>3075212</td>
      <td>-2049351</td>
      <td>1676826</td>
      <td>1524379</td>
      <td>2270501</td>
      <td>31436</td>
      <td>12726</td>
      <td>60454</td>
      <td>781590</td>
      <td>787832</td>
      <td>1051073</td>
      <td>-481</td>
      <td>-95</td>
      <td>-697</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>472994</td>
      <td>795056</td>
      <td>943092</td>
      <td>966348</td>
      <td>1243727</td>
      <td>869544</td>
      <td>171</td>
      <td>141</td>
      <td>132</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>27325115</td>
      <td>24037285</td>
      <td>24492237</td>
      <td>171980718</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 135 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 7479 entries, 0 to 7478
Columns: 135 entries, var1 to costi
dtypes: int64(135)
memory usage: 7.7 MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var1</th>
      <th>var2</th>
      <th>var6</th>
      <th>var7</th>
      <th>var8</th>
      <th>var9</th>
      <th>var10</th>
      <th>var11</th>
      <th>var12</th>
      <th>var13</th>
      <th>var14</th>
      <th>var15</th>
      <th>var16</th>
      <th>var17</th>
      <th>var18</th>
      <th>var19</th>
      <th>var20</th>
      <th>var21</th>
      <th>var22</th>
      <th>var23</th>
      <th>var27</th>
      <th>var28</th>
      <th>var29</th>
      <th>var30</th>
      <th>var31</th>
      <th>var32</th>
      <th>var33</th>
      <th>var34</th>
      <th>var35</th>
      <th>var39</th>
      <th>var40</th>
      <th>var41</th>
      <th>var42</th>
      <th>var43</th>
      <th>var44</th>
      <th>var45</th>
      <th>var46</th>
      <th>var47</th>
      <th>var48</th>
      <th>var49</th>
      <th>...</th>
      <th>var108</th>
      <th>var109</th>
      <th>var110</th>
      <th>var111</th>
      <th>var112</th>
      <th>var113</th>
      <th>var114</th>
      <th>var115</th>
      <th>var116</th>
      <th>var123</th>
      <th>var124</th>
      <th>var125</th>
      <th>var126</th>
      <th>var127</th>
      <th>var128</th>
      <th>var129</th>
      <th>var130</th>
      <th>var131</th>
      <th>var132</th>
      <th>var133</th>
      <th>var134</th>
      <th>var135</th>
      <th>var136</th>
      <th>var137</th>
      <th>var141</th>
      <th>var142</th>
      <th>var143</th>
      <th>var147</th>
      <th>var148</th>
      <th>var149</th>
      <th>var150</th>
      <th>var151</th>
      <th>var152</th>
      <th>var153</th>
      <th>var154</th>
      <th>var155</th>
      <th>var156</th>
      <th>var157</th>
      <th>var158</th>
      <th>costi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>...</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7479.000000</td>
      <td>7479.000000</td>
      <td>7479.000000</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
      <td>7.479000e+03</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>7.450131e+06</td>
      <td>6.995936e+06</td>
      <td>3.377709e+05</td>
      <td>2.954539e+05</td>
      <td>2.374321e+05</td>
      <td>2.080609e+06</td>
      <td>1.977554e+06</td>
      <td>1.866474e+06</td>
      <td>9.678114e+05</td>
      <td>9.397979e+05</td>
      <td>8.494891e+05</td>
      <td>2.730416e+05</td>
      <td>2.483007e+05</td>
      <td>2.281703e+05</td>
      <td>1.867172e+05</td>
      <td>1.722472e+05</td>
      <td>1.578191e+05</td>
      <td>2.484367e+04</td>
      <td>2.069652e+04</td>
      <td>1.858893e+04</td>
      <td>1.325843e+06</td>
      <td>1.256179e+06</td>
      <td>1.160876e+06</td>
      <td>2.188183e+06</td>
      <td>2.161061e+06</td>
      <td>2.019932e+06</td>
      <td>1.505207e+06</td>
      <td>1.506826e+06</td>
      <td>1.418052e+06</td>
      <td>6.012760e+04</td>
      <td>5.466102e+04</td>
      <td>5.602265e+04</td>
      <td>9.828008e+04</td>
      <td>8.966333e+04</td>
      <td>6.497756e+04</td>
      <td>5.901713e+05</td>
      <td>5.677180e+05</td>
      <td>5.011291e+05</td>
      <td>5.604334e+04</td>
      <td>5.130161e+04</td>
      <td>...</td>
      <td>8.240549e+05</td>
      <td>7.776656e+05</td>
      <td>7.208212e+05</td>
      <td>2.562921e+05</td>
      <td>2.444049e+05</td>
      <td>2.225539e+05</td>
      <td>-2.048778e+04</td>
      <td>-2.213982e+04</td>
      <td>-2.373427e+04</td>
      <td>9.113039e+04</td>
      <td>8.943493e+04</td>
      <td>8.721292e+04</td>
      <td>1.517198e+04</td>
      <td>1.664002e+04</td>
      <td>1.264100e+04</td>
      <td>5.208721e+04</td>
      <td>4.878168e+04</td>
      <td>5.321769e+04</td>
      <td>-2.687684e+02</td>
      <td>-2.391546e+03</td>
      <td>3.375687e+02</td>
      <td>-6.536953e+03</td>
      <td>-4.234294e+03</td>
      <td>-4.462733e+03</td>
      <td>8.603223e+04</td>
      <td>8.922157e+04</td>
      <td>9.986623e+04</td>
      <td>1.745804e+05</td>
      <td>1.562779e+05</td>
      <td>1.578679e+05</td>
      <td>21.127958</td>
      <td>20.665062</td>
      <td>19.299773</td>
      <td>6.772403e+04</td>
      <td>6.175881e+04</td>
      <td>6.265347e+04</td>
      <td>1.076427e+06</td>
      <td>9.915747e+05</td>
      <td>9.137636e+05</td>
      <td>7.633431e+06</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.646081e+07</td>
      <td>1.588951e+07</td>
      <td>6.690769e+06</td>
      <td>5.441119e+06</td>
      <td>2.622168e+06</td>
      <td>5.869370e+06</td>
      <td>5.642296e+06</td>
      <td>5.481200e+06</td>
      <td>3.769399e+06</td>
      <td>3.708256e+06</td>
      <td>3.013458e+06</td>
      <td>1.941856e+06</td>
      <td>1.788020e+06</td>
      <td>1.698509e+06</td>
      <td>1.564896e+06</td>
      <td>1.488300e+06</td>
      <td>1.409354e+06</td>
      <td>4.182777e+05</td>
      <td>3.335736e+05</td>
      <td>2.810225e+05</td>
      <td>4.068137e+06</td>
      <td>3.848374e+06</td>
      <td>3.627495e+06</td>
      <td>4.826904e+06</td>
      <td>4.757523e+06</td>
      <td>4.640312e+06</td>
      <td>3.604305e+06</td>
      <td>3.616744e+06</td>
      <td>3.454110e+06</td>
      <td>4.522008e+05</td>
      <td>3.798973e+05</td>
      <td>3.431355e+05</td>
      <td>1.457817e+06</td>
      <td>1.281663e+06</td>
      <td>9.854663e+05</td>
      <td>2.142858e+06</td>
      <td>2.123655e+06</td>
      <td>1.775132e+06</td>
      <td>2.349897e+05</td>
      <td>2.311300e+05</td>
      <td>...</td>
      <td>2.012542e+06</td>
      <td>1.902859e+06</td>
      <td>1.754317e+06</td>
      <td>9.203786e+05</td>
      <td>8.755274e+05</td>
      <td>6.934450e+05</td>
      <td>5.676930e+05</td>
      <td>4.581167e+05</td>
      <td>4.757960e+05</td>
      <td>2.798760e+05</td>
      <td>3.139860e+05</td>
      <td>3.194439e+05</td>
      <td>2.030893e+05</td>
      <td>3.315507e+05</td>
      <td>1.329318e+05</td>
      <td>2.667476e+05</td>
      <td>1.764451e+05</td>
      <td>2.018601e+05</td>
      <td>3.163845e+04</td>
      <td>6.514876e+04</td>
      <td>3.858767e+04</td>
      <td>3.112814e+05</td>
      <td>8.613143e+04</td>
      <td>1.057758e+05</td>
      <td>3.406345e+05</td>
      <td>3.400689e+05</td>
      <td>3.614035e+05</td>
      <td>1.173476e+06</td>
      <td>1.160223e+06</td>
      <td>9.680606e+05</td>
      <td>46.321574</td>
      <td>46.255558</td>
      <td>44.001820</td>
      <td>4.963626e+05</td>
      <td>4.301135e+05</td>
      <td>3.964864e+05</td>
      <td>4.537630e+06</td>
      <td>3.720963e+06</td>
      <td>3.141080e+06</td>
      <td>1.683081e+07</td>
    </tr>
    <tr>
      <th>min</th>
      <td>4.150000e+02</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-2.239386e+07</td>
      <td>-1.435085e+07</td>
      <td>-1.746800e+07</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>-1.448299e+06</td>
      <td>-1.556761e+06</td>
      <td>-1.277128e+06</td>
      <td>-2.626785e+07</td>
      <td>-3.700000e+06</td>
      <td>-7.439191e+06</td>
      <td>-5.930205e+06</td>
      <td>-2.872546e+06</td>
      <td>-1.594206e+06</td>
      <td>-3.335908e+07</td>
      <td>-6.080911e+07</td>
      <td>-3.185507e+07</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>5.184700e+05</td>
      <td>4.002950e+05</td>
      <td>6.975000e+02</td>
      <td>7.300000e+02</td>
      <td>3.775000e+02</td>
      <td>6.432050e+04</td>
      <td>5.949900e+04</td>
      <td>3.985650e+04</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>2.053550e+04</td>
      <td>1.949950e+04</td>
      <td>1.205200e+04</td>
      <td>1.559340e+05</td>
      <td>1.477175e+05</td>
      <td>1.042130e+05</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.458000e+04</td>
      <td>1.615450e+04</td>
      <td>1.075200e+04</td>
      <td>6.000000e+02</td>
      <td>5.625000e+02</td>
      <td>...</td>
      <td>9.125000e+04</td>
      <td>8.197950e+04</td>
      <td>5.863450e+04</td>
      <td>1.444350e+04</td>
      <td>1.248900e+04</td>
      <td>9.404500e+03</td>
      <td>-1.659450e+04</td>
      <td>-2.148750e+04</td>
      <td>-1.365000e+04</td>
      <td>7.652500e+03</td>
      <td>6.483000e+03</td>
      <td>5.034000e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.503500e+03</td>
      <td>1.203000e+03</td>
      <td>7.910000e+02</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.754500e+03</td>
      <td>1.750000e+03</td>
      <td>8.245000e+02</td>
      <td>1.013000e+03</td>
      <td>1.045000e+03</td>
      <td>0.000000e+00</td>
      <td>4.000000</td>
      <td>4.000000</td>
      <td>3.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>5.438740e+05</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.695363e+06</td>
      <td>1.533985e+06</td>
      <td>1.381500e+04</td>
      <td>1.238800e+04</td>
      <td>9.955000e+03</td>
      <td>3.347110e+05</td>
      <td>3.155580e+05</td>
      <td>2.630320e+05</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>6.410000e+02</td>
      <td>6.030000e+02</td>
      <td>3.650000e+02</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.257350e+05</td>
      <td>1.193750e+05</td>
      <td>1.008450e+05</td>
      <td>5.375490e+05</td>
      <td>5.138090e+05</td>
      <td>4.571890e+05</td>
      <td>2.296820e+05</td>
      <td>2.075290e+05</td>
      <td>1.797610e+05</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>6.617500e+04</td>
      <td>6.966300e+04</td>
      <td>5.812100e+04</td>
      <td>5.084000e+03</td>
      <td>4.535000e+03</td>
      <td>...</td>
      <td>2.699830e+05</td>
      <td>2.525620e+05</td>
      <td>2.204670e+05</td>
      <td>4.847200e+04</td>
      <td>4.608400e+04</td>
      <td>4.158700e+04</td>
      <td>0.000000e+00</td>
      <td>-5.000000e+01</td>
      <td>0.000000e+00</td>
      <td>2.294600e+04</td>
      <td>2.142400e+04</td>
      <td>1.997200e+04</td>
      <td>1.400000e+01</td>
      <td>2.000000e+01</td>
      <td>2.400000e+01</td>
      <td>8.236000e+03</td>
      <td>7.691000e+03</td>
      <td>7.702000e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.053200e+04</td>
      <td>1.050300e+04</td>
      <td>1.029100e+04</td>
      <td>1.601000e+04</td>
      <td>1.603900e+04</td>
      <td>1.249900e+04</td>
      <td>10.000000</td>
      <td>9.000000</td>
      <td>9.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>1.145440e+05</td>
      <td>1.071490e+05</td>
      <td>8.262500e+04</td>
      <td>1.760361e+06</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>6.050798e+06</td>
      <td>5.594102e+06</td>
      <td>8.305000e+04</td>
      <td>7.726200e+04</td>
      <td>6.841050e+04</td>
      <td>1.514472e+06</td>
      <td>1.470158e+06</td>
      <td>1.357036e+06</td>
      <td>1.525510e+05</td>
      <td>1.505230e+05</td>
      <td>8.037500e+03</td>
      <td>1.238250e+04</td>
      <td>1.148500e+04</td>
      <td>9.743000e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>7.469065e+05</td>
      <td>7.242070e+05</td>
      <td>6.505790e+05</td>
      <td>1.876297e+06</td>
      <td>1.835515e+06</td>
      <td>1.688428e+06</td>
      <td>1.212872e+06</td>
      <td>1.228060e+06</td>
      <td>1.120250e+06</td>
      <td>8.460000e+02</td>
      <td>1.243500e+03</td>
      <td>1.800000e+03</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>3.167980e+05</td>
      <td>3.178475e+05</td>
      <td>2.838085e+05</td>
      <td>2.642000e+04</td>
      <td>2.368550e+04</td>
      <td>...</td>
      <td>6.861245e+05</td>
      <td>6.513525e+05</td>
      <td>6.123230e+05</td>
      <td>1.769925e+05</td>
      <td>1.651410e+05</td>
      <td>1.541010e+05</td>
      <td>6.946000e+03</td>
      <td>4.335500e+03</td>
      <td>4.780500e+03</td>
      <td>7.280900e+04</td>
      <td>6.995300e+04</td>
      <td>6.879700e+04</td>
      <td>5.370000e+02</td>
      <td>7.200000e+02</td>
      <td>6.890000e+02</td>
      <td>3.309400e+04</td>
      <td>3.361550e+04</td>
      <td>3.634900e+04</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>0.000000e+00</td>
      <td>4.810350e+04</td>
      <td>4.970400e+04</td>
      <td>5.255950e+04</td>
      <td>9.653200e+04</td>
      <td>9.412450e+04</td>
      <td>8.194550e+04</td>
      <td>20.000000</td>
      <td>20.000000</td>
      <td>19.000000</td>
      <td>3.167000e+03</td>
      <td>3.810500e+03</td>
      <td>4.782000e+03</td>
      <td>6.487320e+05</td>
      <td>6.149110e+05</td>
      <td>5.736580e+05</td>
      <td>6.073618e+06</td>
    </tr>
    <tr>
      <th>max</th>
      <td>1.478231e+08</td>
      <td>1.954054e+08</td>
      <td>3.949990e+08</td>
      <td>4.236760e+08</td>
      <td>1.218370e+08</td>
      <td>1.822085e+08</td>
      <td>1.819357e+08</td>
      <td>1.819572e+08</td>
      <td>1.814344e+08</td>
      <td>1.814863e+08</td>
      <td>5.161911e+07</td>
      <td>5.580400e+07</td>
      <td>5.208281e+07</td>
      <td>5.203800e+07</td>
      <td>5.255939e+07</td>
      <td>5.207929e+07</td>
      <td>5.203700e+07</td>
      <td>2.095430e+07</td>
      <td>1.845768e+07</td>
      <td>1.460000e+07</td>
      <td>9.040429e+07</td>
      <td>8.979462e+07</td>
      <td>8.604582e+07</td>
      <td>8.066182e+07</td>
      <td>7.479026e+07</td>
      <td>9.178638e+07</td>
      <td>7.180935e+07</td>
      <td>6.493519e+07</td>
      <td>5.631069e+07</td>
      <td>1.943005e+07</td>
      <td>1.777804e+07</td>
      <td>1.030000e+07</td>
      <td>9.020468e+07</td>
      <td>7.449480e+07</td>
      <td>6.477029e+07</td>
      <td>5.985522e+07</td>
      <td>6.518876e+07</td>
      <td>4.206783e+07</td>
      <td>8.187088e+06</td>
      <td>9.092467e+06</td>
      <td>...</td>
      <td>6.004269e+07</td>
      <td>5.354036e+07</td>
      <td>3.470024e+07</td>
      <td>5.065200e+07</td>
      <td>4.429233e+07</td>
      <td>2.746300e+07</td>
      <td>1.973944e+07</td>
      <td>8.680905e+06</td>
      <td>8.962435e+06</td>
      <td>1.006186e+07</td>
      <td>1.105028e+07</td>
      <td>1.301970e+07</td>
      <td>1.048585e+07</td>
      <td>2.550890e+07</td>
      <td>6.901368e+06</td>
      <td>1.134100e+07</td>
      <td>6.313221e+06</td>
      <td>6.851000e+06</td>
      <td>6.784740e+05</td>
      <td>3.876515e+06</td>
      <td>1.553908e+06</td>
      <td>9.993120e+05</td>
      <td>1.840159e+06</td>
      <td>6.716100e+05</td>
      <td>9.545512e+06</td>
      <td>7.919978e+06</td>
      <td>1.002997e+07</td>
      <td>1.838250e+07</td>
      <td>1.384342e+07</td>
      <td>2.333264e+07</td>
      <td>1384.000000</td>
      <td>1307.000000</td>
      <td>1244.000000</td>
      <td>1.943005e+07</td>
      <td>1.777804e+07</td>
      <td>1.662483e+07</td>
      <td>2.025610e+08</td>
      <td>1.872810e+08</td>
      <td>1.169022e+08</td>
      <td>1.754113e+08</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 135 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(7479, 134)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(7479,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Split the data into a training set and a test set</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>(5235, 134) (2244, 134) (5235,) (2244,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span> <span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>-3200.777457194403
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([-2.30996462e-03, -1.50058663e-02, -2.81813068e-02,  1.84983370e-01,
       -1.07535485e-01, -1.25291295e-02,  1.39249816e-01, -9.91288975e-02,
        4.14284936e-03, -4.74053837e-03, -4.09265041e-04, -1.07988920e-02,
        5.53436241e-02, -4.89814741e-02, -2.08352209e-02,  7.25301721e-02,
       -3.77319133e-02,  8.76194678e-02, -7.65657544e-02,  1.17948143e-01,
       -9.30513956e-01,  1.08357037e+00, -1.26653220e-01,  4.79202414e-03,
        1.43007817e-01, -1.15888295e-01,  9.94973398e-03,  2.70744978e-04,
       -7.92966224e-03,  2.69702385e-02, -4.17703102e-02,  1.29981403e-02,
       -2.03380493e-02,  1.65893118e-01, -1.27604963e-01, -2.66074722e-02,
        1.79488728e-01, -1.18126746e-01, -4.34200642e-02,  1.21637354e-02,
       -1.04109145e-02,  5.60581055e-03, -6.01850048e-02,  4.47773476e-02,
        2.20944502e-02, -1.13635756e-01,  7.64066351e-02,  1.19314776e-04,
        9.93569282e-03, -1.59561082e-02, -7.39703203e-02, -1.36109362e-01,
        1.99741967e-01,  1.20559367e-01, -6.27703586e-02, -1.04838456e-01,
        2.16557279e-03, -9.92887862e-02,  7.54038176e-02,  2.07529998e-03,
        4.41791060e-03,  9.55652299e-04, -5.91073869e-03, -4.61698720e-02,
       -3.67701369e-03,  4.96002655e-02,  3.53159925e-03, -1.41144644e-02,
        1.63627563e-02,  2.72654249e-02,  1.04871684e-02, -3.80283405e-02,
       -1.08564554e-02,  1.39354551e-02,  1.32101117e-03, -4.13592564e-03,
       -5.18201426e-03, -2.56661936e-02, -1.70815551e-01,  1.63681451e-01,
        1.24688231e+00, -4.47986551e-02, -9.86953813e-02, -9.54673606e-01,
        5.20125142e-02, -1.03908251e-01, -2.52766571e-01,  4.74436896e-02,
        1.18334001e-01, -2.33639979e-01,  7.00241620e-02,  9.27074982e-02,
       -3.03265154e-01,  8.86666687e-02,  8.77259902e-02, -2.27952770e-01,
       -1.43269119e-02,  1.39954894e-01, -3.04086786e-01,  1.11272269e-01,
        3.04783758e-02, -1.19847308e+00,  1.00332024e-02,  1.20315710e-01,
       -1.96644059e-01, -9.27282850e-02,  1.83966606e-01,  1.92388403e-01,
        1.04369772e-01, -1.97001878e-01, -8.36998547e-02, -1.21567478e-01,
        8.16877455e-02, -5.26305994e-01, -3.52562902e-02, -1.94390763e-01,
        2.07845429e-01, -8.20499899e-01, -1.30818522e-03, -3.24226028e-01,
        1.05224108e-01,  5.12933641e-02, -2.29442019e-01, -2.68507534e-03,
        1.74531598e-01,  6.62690395e+02, -2.30495434e+02,  2.22724695e+02,
       -2.02134192e-02,  1.36489920e-02,  9.06889487e-03,  2.07529998e-03,
        4.41791060e-03,  9.55652299e-04])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">length</span> <span class="o">=</span> <span class="n">y_predict</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#  </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;costi_reali&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;costi_predetti&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_17_0.png" src="../../_images/regressore_custom_data_17_0.png" />
</div>
</div>
<div class="section" id="export-coeff-of-regressor">
<h2>Export coeff of regressor<a class="headerlink" href="#export-coeff-of-regressor" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coeff</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
<span class="n">coeff</span>

<span class="c1">### EXPORT THE COEFF OF REGRESSOR</span>
<span class="n">formula_excel</span> <span class="o">=</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">coeff</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;coeff&#39;</span><span class="p">])</span>
<span class="n">formula_excel</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;formula.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="export-prediction-in-a-final-column">
<h2>Export Prediction in a final column<a class="headerlink" href="#export-prediction-in-a-final-column" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;costi_PRED&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
<span class="n">data</span><span class="p">[[</span><span class="s1">&#39;costi&#39;</span><span class="p">,</span> <span class="s1">&#39;costi_PRED&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>costi</th>
      <th>costi_PRED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>144205134</td>
      <td>1.443731e+08</td>
    </tr>
    <tr>
      <th>1</th>
      <td>140165127</td>
      <td>1.379588e+08</td>
    </tr>
    <tr>
      <th>2</th>
      <td>145190000</td>
      <td>1.444782e+08</td>
    </tr>
    <tr>
      <th>3</th>
      <td>112760368</td>
      <td>1.130755e+08</td>
    </tr>
    <tr>
      <th>4</th>
      <td>171980718</td>
      <td>1.734026e+08</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#save the data</span>
<span class="n">data</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;result1.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="export-model">
<h2>Export model<a class="headerlink" href="#export-model" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pickle</span>
<span class="n">pickle</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span> <span class="n">model</span><span class="p">,</span> <span class="nb">open</span><span class="p">(</span> <span class="s1">&#39;model.p&#39;</span><span class="p">,</span> <span class="s1">&#39;wb&#39;</span> <span class="p">)</span> <span class="p">)</span>
<span class="c1"># modello di regressione lineare con tutte le 134 Xi</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="import-the-model-pickle-with-new-data">
<h2>Import the model (pickle) with new data<a class="headerlink" href="#import-the-model-pickle-with-new-data" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">google.colab</span> <span class="kn">import</span> <span class="n">files</span>
<span class="n">uploaded</span> <span class="o">=</span> <span class="n">files</span><span class="o">.</span><span class="n">upload</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html">
<input type="file" id="files-0597cfd5-b227-4e0c-b237-caf9b1f3afa9" name="files[]" multiple disabled />
<output id="result-0597cfd5-b227-4e0c-b237-caf9b1f3afa9">
 Upload widget is only available when the cell has been executed in the
 current browser session. Please rerun this cell to enable.
 </output>
 <script src="/nbextensions/google.colab/files.js"></script> </div><div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Saving test_cost.xlsx to test_cost.xlsx
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Loading a new dataset</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_excel</span><span class="p">(</span><span class="s1">&#39;test_cost.xlsx&#39;</span><span class="p">)</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[:,</span><span class="mi">0</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(100, 134)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#Load the pickled object. </span>
<span class="n">model</span> <span class="o">=</span> <span class="n">pickle</span><span class="o">.</span><span class="n">load</span><span class="p">(</span> <span class="nb">open</span><span class="p">(</span> <span class="s2">&quot;model.p&quot;</span><span class="p">,</span> <span class="s2">&quot;rb&quot;</span> <span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;costi_PRED&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
<span class="n">df</span><span class="p">[[</span><span class="s1">&#39;costi&#39;</span><span class="p">,</span> <span class="s1">&#39;costi_PRED&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>costi</th>
      <th>costi_PRED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2508929000</td>
      <td>2.522365e+09</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2173873000</td>
      <td>2.171454e+09</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1526367000</td>
      <td>1.572747e+09</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1174142000</td>
      <td>1.166190e+09</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>-4.325780e+07</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#  </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">)</span>


<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;costi_reali&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;costi_predetti&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_32_0.png" src="../../_images/regressore_custom_data_32_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">#save the data</span>
<span class="n">df</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;result_new_dataset.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="reduce-number-of-regressor-8-regressors">
<h2>Reduce number of regressor 8 regressors<a class="headerlink" href="#reduce-number-of-regressor-8-regressors" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">data2</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="k">del</span> <span class="n">data2</span><span class="p">[</span><span class="s1">&#39;costi_PRED&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">corrmat</span> <span class="o">=</span> <span class="n">data2</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corrmat</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var1</th>
      <th>var2</th>
      <th>var6</th>
      <th>var7</th>
      <th>var8</th>
      <th>var9</th>
      <th>var10</th>
      <th>var11</th>
      <th>var12</th>
      <th>var13</th>
      <th>var14</th>
      <th>var15</th>
      <th>var16</th>
      <th>var17</th>
      <th>var18</th>
      <th>var19</th>
      <th>var20</th>
      <th>var21</th>
      <th>var22</th>
      <th>var23</th>
      <th>var27</th>
      <th>var28</th>
      <th>var29</th>
      <th>var30</th>
      <th>var31</th>
      <th>var32</th>
      <th>var33</th>
      <th>var34</th>
      <th>var35</th>
      <th>var39</th>
      <th>var40</th>
      <th>var41</th>
      <th>var42</th>
      <th>var43</th>
      <th>var44</th>
      <th>var45</th>
      <th>var46</th>
      <th>var47</th>
      <th>var48</th>
      <th>var49</th>
      <th>...</th>
      <th>var108</th>
      <th>var109</th>
      <th>var110</th>
      <th>var111</th>
      <th>var112</th>
      <th>var113</th>
      <th>var114</th>
      <th>var115</th>
      <th>var116</th>
      <th>var123</th>
      <th>var124</th>
      <th>var125</th>
      <th>var126</th>
      <th>var127</th>
      <th>var128</th>
      <th>var129</th>
      <th>var130</th>
      <th>var131</th>
      <th>var132</th>
      <th>var133</th>
      <th>var134</th>
      <th>var135</th>
      <th>var136</th>
      <th>var137</th>
      <th>var141</th>
      <th>var142</th>
      <th>var143</th>
      <th>var147</th>
      <th>var148</th>
      <th>var149</th>
      <th>var150</th>
      <th>var151</th>
      <th>var152</th>
      <th>var153</th>
      <th>var154</th>
      <th>var155</th>
      <th>var156</th>
      <th>var157</th>
      <th>var158</th>
      <th>costi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var1</th>
      <td>1.000000</td>
      <td>0.986345</td>
      <td>0.135692</td>
      <td>0.130403</td>
      <td>0.235256</td>
      <td>0.652578</td>
      <td>0.639252</td>
      <td>0.625818</td>
      <td>0.522128</td>
      <td>0.517458</td>
      <td>0.624950</td>
      <td>0.415115</td>
      <td>0.386054</td>
      <td>0.369241</td>
      <td>0.381076</td>
      <td>0.351668</td>
      <td>0.337167</td>
      <td>0.187145</td>
      <td>0.182562</td>
      <td>0.213661</td>
      <td>0.643967</td>
      <td>0.652575</td>
      <td>0.653724</td>
      <td>0.885616</td>
      <td>0.901770</td>
      <td>0.889494</td>
      <td>0.849578</td>
      <td>0.871460</td>
      <td>0.873803</td>
      <td>0.206912</td>
      <td>0.217005</td>
      <td>0.260878</td>
      <td>0.152898</td>
      <td>0.170960</td>
      <td>0.167835</td>
      <td>0.561514</td>
      <td>0.529838</td>
      <td>0.551337</td>
      <td>0.342868</td>
      <td>0.313105</td>
      <td>...</td>
      <td>0.738153</td>
      <td>0.747532</td>
      <td>0.763650</td>
      <td>0.557382</td>
      <td>0.591085</td>
      <td>0.674079</td>
      <td>-0.081304</td>
      <td>-0.108396</td>
      <td>-0.161343</td>
      <td>0.458148</td>
      <td>0.441197</td>
      <td>0.424094</td>
      <td>0.188005</td>
      <td>0.141545</td>
      <td>0.265174</td>
      <td>0.387952</td>
      <td>0.532638</td>
      <td>0.535435</td>
      <td>-0.033266</td>
      <td>-0.075452</td>
      <td>0.034593</td>
      <td>-0.030284</td>
      <td>-0.157753</td>
      <td>-0.136756</td>
      <td>0.503319</td>
      <td>0.566754</td>
      <td>0.620623</td>
      <td>0.374695</td>
      <td>0.314028</td>
      <td>0.392427</td>
      <td>0.639018</td>
      <td>0.626608</td>
      <td>0.642236</td>
      <td>0.188735</td>
      <td>0.188945</td>
      <td>0.223395</td>
      <td>0.456726</td>
      <td>0.488830</td>
      <td>0.537188</td>
      <td>0.986153</td>
    </tr>
    <tr>
      <th>var2</th>
      <td>0.986345</td>
      <td>1.000000</td>
      <td>0.183263</td>
      <td>0.193421</td>
      <td>0.267485</td>
      <td>0.656802</td>
      <td>0.644170</td>
      <td>0.635073</td>
      <td>0.529413</td>
      <td>0.525425</td>
      <td>0.638663</td>
      <td>0.416329</td>
      <td>0.389934</td>
      <td>0.370164</td>
      <td>0.378868</td>
      <td>0.351583</td>
      <td>0.336201</td>
      <td>0.188228</td>
      <td>0.182147</td>
      <td>0.214706</td>
      <td>0.637955</td>
      <td>0.648195</td>
      <td>0.653929</td>
      <td>0.883733</td>
      <td>0.895384</td>
      <td>0.894533</td>
      <td>0.852143</td>
      <td>0.868651</td>
      <td>0.883315</td>
      <td>0.217426</td>
      <td>0.220016</td>
      <td>0.264968</td>
      <td>0.152903</td>
      <td>0.168143</td>
      <td>0.169033</td>
      <td>0.553340</td>
      <td>0.528199</td>
      <td>0.553966</td>
      <td>0.330029</td>
      <td>0.305480</td>
      <td>...</td>
      <td>0.726053</td>
      <td>0.733222</td>
      <td>0.767513</td>
      <td>0.594631</td>
      <td>0.603129</td>
      <td>0.712480</td>
      <td>-0.078030</td>
      <td>-0.105031</td>
      <td>-0.157499</td>
      <td>0.464254</td>
      <td>0.447246</td>
      <td>0.434021</td>
      <td>0.186468</td>
      <td>0.152456</td>
      <td>0.271204</td>
      <td>0.413598</td>
      <td>0.548888</td>
      <td>0.565061</td>
      <td>-0.065981</td>
      <td>-0.084900</td>
      <td>0.030522</td>
      <td>-0.042834</td>
      <td>-0.174988</td>
      <td>-0.136803</td>
      <td>0.465343</td>
      <td>0.548087</td>
      <td>0.623318</td>
      <td>0.341054</td>
      <td>0.290481</td>
      <td>0.381861</td>
      <td>0.630293</td>
      <td>0.620489</td>
      <td>0.642667</td>
      <td>0.198160</td>
      <td>0.191570</td>
      <td>0.226940</td>
      <td>0.476820</td>
      <td>0.518401</td>
      <td>0.542348</td>
      <td>0.976198</td>
    </tr>
    <tr>
      <th>var6</th>
      <td>0.135692</td>
      <td>0.183263</td>
      <td>1.000000</td>
      <td>0.873993</td>
      <td>0.813696</td>
      <td>0.189718</td>
      <td>0.182933</td>
      <td>0.165854</td>
      <td>0.131329</td>
      <td>0.127274</td>
      <td>0.139800</td>
      <td>0.335777</td>
      <td>0.130861</td>
      <td>0.101365</td>
      <td>0.259090</td>
      <td>0.096747</td>
      <td>0.087498</td>
      <td>0.003349</td>
      <td>0.003959</td>
      <td>0.006180</td>
      <td>0.113859</td>
      <td>0.109382</td>
      <td>0.099655</td>
      <td>0.148542</td>
      <td>0.155342</td>
      <td>0.128628</td>
      <td>0.128418</td>
      <td>0.143798</td>
      <td>0.123677</td>
      <td>0.097007</td>
      <td>0.055760</td>
      <td>0.051068</td>
      <td>0.005120</td>
      <td>0.005173</td>
      <td>0.008444</td>
      <td>0.089825</td>
      <td>0.176643</td>
      <td>0.165656</td>
      <td>0.055283</td>
      <td>0.023465</td>
      <td>...</td>
      <td>0.184832</td>
      <td>0.138871</td>
      <td>0.182232</td>
      <td>0.674075</td>
      <td>0.334837</td>
      <td>0.517908</td>
      <td>0.001620</td>
      <td>-0.048689</td>
      <td>-0.013749</td>
      <td>0.107458</td>
      <td>0.085651</td>
      <td>0.087308</td>
      <td>0.059003</td>
      <td>0.078457</td>
      <td>0.122742</td>
      <td>0.622851</td>
      <td>0.224365</td>
      <td>0.521631</td>
      <td>-0.216426</td>
      <td>0.005878</td>
      <td>-0.069827</td>
      <td>-0.004018</td>
      <td>0.025614</td>
      <td>-0.184567</td>
      <td>-0.090820</td>
      <td>0.202786</td>
      <td>0.202446</td>
      <td>-0.125143</td>
      <td>0.031223</td>
      <td>0.106843</td>
      <td>0.145932</td>
      <td>0.139871</td>
      <td>0.135043</td>
      <td>0.087843</td>
      <td>0.048679</td>
      <td>0.043582</td>
      <td>0.752713</td>
      <td>0.479469</td>
      <td>0.243378</td>
      <td>0.176026</td>
    </tr>
    <tr>
      <th>var7</th>
      <td>0.130403</td>
      <td>0.193421</td>
      <td>0.873993</td>
      <td>1.000000</td>
      <td>0.725537</td>
      <td>0.226065</td>
      <td>0.216583</td>
      <td>0.194307</td>
      <td>0.151139</td>
      <td>0.145181</td>
      <td>0.156576</td>
      <td>0.219797</td>
      <td>0.143006</td>
      <td>0.104691</td>
      <td>0.167873</td>
      <td>0.099393</td>
      <td>0.089165</td>
      <td>0.002658</td>
      <td>0.002687</td>
      <td>0.006144</td>
      <td>0.125486</td>
      <td>0.113749</td>
      <td>0.104222</td>
      <td>0.166999</td>
      <td>0.175232</td>
      <td>0.145167</td>
      <td>0.156505</td>
      <td>0.176031</td>
      <td>0.147110</td>
      <td>0.129380</td>
      <td>0.052250</td>
      <td>0.051619</td>
      <td>0.007890</td>
      <td>0.007631</td>
      <td>0.012758</td>
      <td>0.103887</td>
      <td>0.144036</td>
      <td>0.178280</td>
      <td>0.040511</td>
      <td>0.028061</td>
      <td>...</td>
      <td>0.189389</td>
      <td>0.127823</td>
      <td>0.182980</td>
      <td>0.748622</td>
      <td>0.354451</td>
      <td>0.591595</td>
      <td>-0.006842</td>
      <td>-0.050565</td>
      <td>-0.008803</td>
      <td>0.114722</td>
      <td>0.079594</td>
      <td>0.102993</td>
      <td>0.053131</td>
      <td>0.101960</td>
      <td>0.150623</td>
      <td>0.498843</td>
      <td>0.280969</td>
      <td>0.427650</td>
      <td>-0.335108</td>
      <td>0.048683</td>
      <td>-0.111728</td>
      <td>-0.003179</td>
      <td>0.028650</td>
      <td>-0.200492</td>
      <td>-0.115681</td>
      <td>0.134505</td>
      <td>0.202609</td>
      <td>-0.158951</td>
      <td>-0.029327</td>
      <td>0.084978</td>
      <td>0.151873</td>
      <td>0.147328</td>
      <td>0.136093</td>
      <td>0.117306</td>
      <td>0.045500</td>
      <td>0.044010</td>
      <td>0.652591</td>
      <td>0.635520</td>
      <td>0.317137</td>
      <td>0.184230</td>
    </tr>
    <tr>
      <th>var8</th>
      <td>0.235256</td>
      <td>0.267485</td>
      <td>0.813696</td>
      <td>0.725537</td>
      <td>1.000000</td>
      <td>0.265146</td>
      <td>0.266050</td>
      <td>0.246782</td>
      <td>0.206811</td>
      <td>0.205262</td>
      <td>0.207759</td>
      <td>0.363357</td>
      <td>0.211711</td>
      <td>0.196459</td>
      <td>0.298309</td>
      <td>0.178568</td>
      <td>0.184040</td>
      <td>0.006438</td>
      <td>0.006876</td>
      <td>0.014061</td>
      <td>0.157938</td>
      <td>0.157350</td>
      <td>0.144310</td>
      <td>0.222544</td>
      <td>0.228397</td>
      <td>0.213953</td>
      <td>0.195191</td>
      <td>0.206778</td>
      <td>0.197445</td>
      <td>0.078609</td>
      <td>0.065872</td>
      <td>0.071788</td>
      <td>0.020384</td>
      <td>0.019720</td>
      <td>0.025038</td>
      <td>0.147141</td>
      <td>0.210100</td>
      <td>0.266617</td>
      <td>0.084317</td>
      <td>0.061866</td>
      <td>...</td>
      <td>0.247220</td>
      <td>0.235928</td>
      <td>0.261570</td>
      <td>0.617437</td>
      <td>0.510830</td>
      <td>0.597908</td>
      <td>-0.008968</td>
      <td>-0.097494</td>
      <td>-0.007816</td>
      <td>0.167191</td>
      <td>0.169458</td>
      <td>0.136359</td>
      <td>0.073326</td>
      <td>0.214011</td>
      <td>0.352343</td>
      <td>0.600951</td>
      <td>0.449527</td>
      <td>0.642732</td>
      <td>-0.081671</td>
      <td>0.264306</td>
      <td>-0.198528</td>
      <td>-0.002500</td>
      <td>0.070876</td>
      <td>-0.465443</td>
      <td>0.017319</td>
      <td>0.243098</td>
      <td>0.260698</td>
      <td>-0.111626</td>
      <td>0.026316</td>
      <td>0.082273</td>
      <td>0.197056</td>
      <td>0.190604</td>
      <td>0.191515</td>
      <td>0.070684</td>
      <td>0.057094</td>
      <td>0.061017</td>
      <td>0.708195</td>
      <td>0.452155</td>
      <td>0.439678</td>
      <td>0.243066</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>var155</th>
      <td>0.223395</td>
      <td>0.226940</td>
      <td>0.043582</td>
      <td>0.044010</td>
      <td>0.061017</td>
      <td>0.202353</td>
      <td>0.202773</td>
      <td>0.201791</td>
      <td>0.166981</td>
      <td>0.163899</td>
      <td>0.199016</td>
      <td>0.128268</td>
      <td>0.126408</td>
      <td>0.120588</td>
      <td>0.118179</td>
      <td>0.114071</td>
      <td>0.110688</td>
      <td>0.015444</td>
      <td>0.016602</td>
      <td>0.023159</td>
      <td>0.138535</td>
      <td>0.145335</td>
      <td>0.156384</td>
      <td>0.305291</td>
      <td>0.327402</td>
      <td>0.325720</td>
      <td>0.251763</td>
      <td>0.262242</td>
      <td>0.250124</td>
      <td>0.576255</td>
      <td>0.675614</td>
      <td>0.862762</td>
      <td>0.004004</td>
      <td>0.003298</td>
      <td>0.012819</td>
      <td>0.125483</td>
      <td>0.102116</td>
      <td>0.109212</td>
      <td>0.134293</td>
      <td>0.113861</td>
      <td>...</td>
      <td>0.171965</td>
      <td>0.176136</td>
      <td>0.183390</td>
      <td>0.177772</td>
      <td>0.171289</td>
      <td>0.206994</td>
      <td>-0.010671</td>
      <td>0.017562</td>
      <td>-0.024172</td>
      <td>0.152030</td>
      <td>0.140095</td>
      <td>0.179137</td>
      <td>0.051656</td>
      <td>0.034954</td>
      <td>0.154785</td>
      <td>0.188886</td>
      <td>0.220122</td>
      <td>0.223574</td>
      <td>-0.057395</td>
      <td>-0.054727</td>
      <td>0.035122</td>
      <td>-0.017513</td>
      <td>-0.055084</td>
      <td>-0.011086</td>
      <td>0.088607</td>
      <td>0.100526</td>
      <td>0.105844</td>
      <td>0.019526</td>
      <td>0.030046</td>
      <td>0.055176</td>
      <td>0.137069</td>
      <td>0.136641</td>
      <td>0.141692</td>
      <td>0.722125</td>
      <td>0.827372</td>
      <td>1.000000</td>
      <td>0.192632</td>
      <td>0.232049</td>
      <td>0.277538</td>
      <td>0.219139</td>
    </tr>
    <tr>
      <th>var156</th>
      <td>0.456726</td>
      <td>0.476820</td>
      <td>0.752713</td>
      <td>0.652591</td>
      <td>0.708195</td>
      <td>0.578031</td>
      <td>0.564299</td>
      <td>0.533198</td>
      <td>0.458980</td>
      <td>0.444540</td>
      <td>0.504364</td>
      <td>0.452596</td>
      <td>0.297705</td>
      <td>0.269472</td>
      <td>0.397359</td>
      <td>0.274203</td>
      <td>0.262533</td>
      <td>0.086206</td>
      <td>0.092490</td>
      <td>0.101815</td>
      <td>0.435457</td>
      <td>0.433399</td>
      <td>0.409762</td>
      <td>0.469106</td>
      <td>0.483043</td>
      <td>0.454719</td>
      <td>0.410637</td>
      <td>0.430182</td>
      <td>0.412124</td>
      <td>0.210692</td>
      <td>0.154981</td>
      <td>0.199667</td>
      <td>0.042844</td>
      <td>0.038677</td>
      <td>0.016677</td>
      <td>0.260620</td>
      <td>0.313495</td>
      <td>0.305936</td>
      <td>0.227179</td>
      <td>0.178598</td>
      <td>...</td>
      <td>0.415474</td>
      <td>0.386672</td>
      <td>0.415266</td>
      <td>0.730107</td>
      <td>0.523319</td>
      <td>0.671638</td>
      <td>-0.040482</td>
      <td>-0.092845</td>
      <td>-0.093796</td>
      <td>0.289609</td>
      <td>0.283453</td>
      <td>0.313727</td>
      <td>0.136388</td>
      <td>0.151322</td>
      <td>0.281111</td>
      <td>0.693159</td>
      <td>0.540685</td>
      <td>0.713428</td>
      <td>-0.154815</td>
      <td>0.045929</td>
      <td>-0.046221</td>
      <td>-0.024945</td>
      <td>-0.017496</td>
      <td>-0.296575</td>
      <td>0.069369</td>
      <td>0.319128</td>
      <td>0.329185</td>
      <td>-0.012658</td>
      <td>0.103984</td>
      <td>0.169218</td>
      <td>0.349209</td>
      <td>0.335781</td>
      <td>0.335507</td>
      <td>0.207735</td>
      <td>0.154641</td>
      <td>0.192632</td>
      <td>1.000000</td>
      <td>0.800378</td>
      <td>0.698905</td>
      <td>0.482840</td>
    </tr>
    <tr>
      <th>var157</th>
      <td>0.488830</td>
      <td>0.518401</td>
      <td>0.479469</td>
      <td>0.635520</td>
      <td>0.452155</td>
      <td>0.656210</td>
      <td>0.645442</td>
      <td>0.611144</td>
      <td>0.515172</td>
      <td>0.502036</td>
      <td>0.573969</td>
      <td>0.323258</td>
      <td>0.336961</td>
      <td>0.292983</td>
      <td>0.285183</td>
      <td>0.290790</td>
      <td>0.266979</td>
      <td>0.104310</td>
      <td>0.115773</td>
      <td>0.123223</td>
      <td>0.454784</td>
      <td>0.451243</td>
      <td>0.440515</td>
      <td>0.516594</td>
      <td>0.539544</td>
      <td>0.516462</td>
      <td>0.474865</td>
      <td>0.500620</td>
      <td>0.481140</td>
      <td>0.237844</td>
      <td>0.181698</td>
      <td>0.239888</td>
      <td>0.041072</td>
      <td>0.037496</td>
      <td>0.023761</td>
      <td>0.279626</td>
      <td>0.299713</td>
      <td>0.313378</td>
      <td>0.232222</td>
      <td>0.210832</td>
      <td>...</td>
      <td>0.438662</td>
      <td>0.400436</td>
      <td>0.440466</td>
      <td>0.748071</td>
      <td>0.511556</td>
      <td>0.704817</td>
      <td>-0.049675</td>
      <td>-0.079458</td>
      <td>-0.124970</td>
      <td>0.330287</td>
      <td>0.311307</td>
      <td>0.359791</td>
      <td>0.153271</td>
      <td>0.247595</td>
      <td>0.213060</td>
      <td>0.546249</td>
      <td>0.626313</td>
      <td>0.583229</td>
      <td>-0.258613</td>
      <td>-0.054892</td>
      <td>-0.005612</td>
      <td>-0.066081</td>
      <td>-0.086703</td>
      <td>-0.165852</td>
      <td>0.074250</td>
      <td>0.241839</td>
      <td>0.319580</td>
      <td>-0.000928</td>
      <td>0.072383</td>
      <td>0.144425</td>
      <td>0.378126</td>
      <td>0.368310</td>
      <td>0.368484</td>
      <td>0.236244</td>
      <td>0.182645</td>
      <td>0.232049</td>
      <td>0.800378</td>
      <td>1.000000</td>
      <td>0.777121</td>
      <td>0.524987</td>
    </tr>
    <tr>
      <th>var158</th>
      <td>0.537188</td>
      <td>0.542348</td>
      <td>0.243378</td>
      <td>0.317137</td>
      <td>0.439678</td>
      <td>0.682216</td>
      <td>0.684901</td>
      <td>0.684083</td>
      <td>0.570262</td>
      <td>0.562681</td>
      <td>0.652159</td>
      <td>0.353212</td>
      <td>0.377000</td>
      <td>0.368508</td>
      <td>0.333145</td>
      <td>0.350430</td>
      <td>0.352395</td>
      <td>0.107082</td>
      <td>0.116334</td>
      <td>0.123803</td>
      <td>0.483165</td>
      <td>0.489269</td>
      <td>0.490547</td>
      <td>0.548446</td>
      <td>0.567178</td>
      <td>0.554446</td>
      <td>0.483307</td>
      <td>0.495304</td>
      <td>0.490955</td>
      <td>0.214167</td>
      <td>0.222927</td>
      <td>0.286564</td>
      <td>0.045740</td>
      <td>0.041128</td>
      <td>0.024487</td>
      <td>0.277906</td>
      <td>0.272270</td>
      <td>0.341752</td>
      <td>0.245506</td>
      <td>0.231290</td>
      <td>...</td>
      <td>0.446247</td>
      <td>0.449236</td>
      <td>0.471581</td>
      <td>0.555260</td>
      <td>0.553331</td>
      <td>0.643753</td>
      <td>-0.069377</td>
      <td>-0.074575</td>
      <td>-0.131576</td>
      <td>0.353918</td>
      <td>0.354668</td>
      <td>0.399339</td>
      <td>0.152856</td>
      <td>0.081858</td>
      <td>0.402450</td>
      <td>0.427419</td>
      <td>0.662039</td>
      <td>0.669947</td>
      <td>-0.068658</td>
      <td>0.173842</td>
      <td>-0.114673</td>
      <td>-0.078316</td>
      <td>0.013429</td>
      <td>-0.420892</td>
      <td>0.207181</td>
      <td>0.285600</td>
      <td>0.296679</td>
      <td>0.049811</td>
      <td>0.051782</td>
      <td>0.095128</td>
      <td>0.387896</td>
      <td>0.380843</td>
      <td>0.393833</td>
      <td>0.217472</td>
      <td>0.223513</td>
      <td>0.277538</td>
      <td>0.698905</td>
      <td>0.777121</td>
      <td>1.000000</td>
      <td>0.535850</td>
    </tr>
    <tr>
      <th>costi</th>
      <td>0.986153</td>
      <td>0.976198</td>
      <td>0.176026</td>
      <td>0.184230</td>
      <td>0.243066</td>
      <td>0.663195</td>
      <td>0.645689</td>
      <td>0.623935</td>
      <td>0.526338</td>
      <td>0.519144</td>
      <td>0.620732</td>
      <td>0.412508</td>
      <td>0.386070</td>
      <td>0.362460</td>
      <td>0.375275</td>
      <td>0.349002</td>
      <td>0.328834</td>
      <td>0.185970</td>
      <td>0.182333</td>
      <td>0.213124</td>
      <td>0.651736</td>
      <td>0.654572</td>
      <td>0.638381</td>
      <td>0.892665</td>
      <td>0.896231</td>
      <td>0.874316</td>
      <td>0.865041</td>
      <td>0.873108</td>
      <td>0.864293</td>
      <td>0.205703</td>
      <td>0.211874</td>
      <td>0.256292</td>
      <td>0.151247</td>
      <td>0.170439</td>
      <td>0.164481</td>
      <td>0.562900</td>
      <td>0.519217</td>
      <td>0.545312</td>
      <td>0.340801</td>
      <td>0.312354</td>
      <td>...</td>
      <td>0.758261</td>
      <td>0.753295</td>
      <td>0.765291</td>
      <td>0.595142</td>
      <td>0.576023</td>
      <td>0.690973</td>
      <td>-0.104126</td>
      <td>-0.131195</td>
      <td>-0.162064</td>
      <td>0.458831</td>
      <td>0.423249</td>
      <td>0.409725</td>
      <td>0.188688</td>
      <td>0.140951</td>
      <td>0.248732</td>
      <td>0.400310</td>
      <td>0.515660</td>
      <td>0.524363</td>
      <td>-0.062510</td>
      <td>-0.096260</td>
      <td>0.036555</td>
      <td>-0.032482</td>
      <td>-0.157398</td>
      <td>-0.124410</td>
      <td>0.507332</td>
      <td>0.565530</td>
      <td>0.625243</td>
      <td>0.387224</td>
      <td>0.337390</td>
      <td>0.416265</td>
      <td>0.654021</td>
      <td>0.631454</td>
      <td>0.640518</td>
      <td>0.187614</td>
      <td>0.184095</td>
      <td>0.219139</td>
      <td>0.482840</td>
      <td>0.524987</td>
      <td>0.535850</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>135 rows × 135 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">corrmat</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_37_0.png" src="../../_images/regressore_custom_data_37_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">corrmat</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([&#39;var1&#39;, &#39;var2&#39;, &#39;var6&#39;, &#39;var7&#39;, &#39;var8&#39;, &#39;var9&#39;, &#39;var10&#39;, &#39;var11&#39;,
       &#39;var12&#39;, &#39;var13&#39;, &#39;var14&#39;, &#39;var15&#39;, &#39;var16&#39;, &#39;var17&#39;, &#39;var18&#39;,
       &#39;var19&#39;, &#39;var20&#39;, &#39;var21&#39;, &#39;var22&#39;, &#39;var23&#39;, &#39;var27&#39;, &#39;var28&#39;,
       &#39;var29&#39;, &#39;var30&#39;, &#39;var31&#39;, &#39;var32&#39;, &#39;var33&#39;, &#39;var34&#39;, &#39;var35&#39;,
       &#39;var39&#39;, &#39;var40&#39;, &#39;var41&#39;, &#39;var42&#39;, &#39;var43&#39;, &#39;var44&#39;, &#39;var45&#39;,
       &#39;var46&#39;, &#39;var47&#39;, &#39;var48&#39;, &#39;var49&#39;, &#39;var50&#39;, &#39;var51&#39;, &#39;var52&#39;,
       &#39;var53&#39;, &#39;var54&#39;, &#39;var55&#39;, &#39;var56&#39;, &#39;var57&#39;, &#39;var58&#39;, &#39;var59&#39;,
       &#39;var60&#39;, &#39;var61&#39;, &#39;var62&#39;, &#39;var63&#39;, &#39;var64&#39;, &#39;var65&#39;, &#39;var66&#39;,
       &#39;var67&#39;, &#39;var68&#39;, &#39;var69&#39;, &#39;var70&#39;, &#39;var71&#39;, &#39;var72&#39;, &#39;var73&#39;,
       &#39;var74&#39;, &#39;var75&#39;, &#39;var76&#39;, &#39;var77&#39;, &#39;var78&#39;, &#39;var79&#39;, &#39;var80&#39;,
       &#39;var81&#39;, &#39;var82&#39;, &#39;var83&#39;, &#39;var84&#39;, &#39;var85&#39;, &#39;var86&#39;, &#39;var90&#39;,
       &#39;var91&#39;, &#39;var92&#39;, &#39;var93&#39;, &#39;var94&#39;, &#39;var95&#39;, &#39;var96&#39;, &#39;var97&#39;,
       &#39;var98&#39;, &#39;var99&#39;, &#39;var100&#39;, &#39;var101&#39;, &#39;var102&#39;, &#39;var103&#39;, &#39;var104&#39;,
       &#39;var105&#39;, &#39;var106&#39;, &#39;var107&#39;, &#39;var108&#39;, &#39;var109&#39;, &#39;var110&#39;,
       &#39;var111&#39;, &#39;var112&#39;, &#39;var113&#39;, &#39;var114&#39;, &#39;var115&#39;, &#39;var116&#39;,
       &#39;var123&#39;, &#39;var124&#39;, &#39;var125&#39;, &#39;var126&#39;, &#39;var127&#39;, &#39;var128&#39;,
       &#39;var129&#39;, &#39;var130&#39;, &#39;var131&#39;, &#39;var132&#39;, &#39;var133&#39;, &#39;var134&#39;,
       &#39;var135&#39;, &#39;var136&#39;, &#39;var137&#39;, &#39;var141&#39;, &#39;var142&#39;, &#39;var143&#39;,
       &#39;var147&#39;, &#39;var148&#39;, &#39;var149&#39;, &#39;var150&#39;, &#39;var151&#39;, &#39;var152&#39;,
       &#39;var153&#39;, &#39;var154&#39;, &#39;var155&#39;, &#39;var156&#39;, &#39;var157&#39;, &#39;var158&#39;,
       &#39;costi&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">getCorrelatedFeature</span><span class="p">(</span><span class="n">corrdata</span><span class="p">,</span> <span class="n">threshold</span><span class="p">):</span>
    <span class="n">feature</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">value</span> <span class="o">=</span> <span class="p">[]</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">corrdata</span><span class="o">.</span><span class="n">index</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">corrdata</span><span class="p">[</span><span class="n">index</span><span class="p">])</span><span class="o">&gt;</span> <span class="n">threshold</span><span class="p">:</span>
            <span class="n">feature</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="n">value</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">corrdata</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
            
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">value</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">feature</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Corr Value&#39;</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.90</span>
<span class="n">corr_value</span> <span class="o">=</span> <span class="n">getCorrelatedFeature</span><span class="p">(</span><span class="n">corrmat</span><span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">],</span> <span class="n">threshold</span><span class="p">)</span>
<span class="n">corr_value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Corr Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>var1</th>
      <td>0.986153</td>
    </tr>
    <tr>
      <th>var2</th>
      <td>0.976198</td>
    </tr>
    <tr>
      <th>var93</th>
      <td>0.998334</td>
    </tr>
    <tr>
      <th>var94</th>
      <td>0.985817</td>
    </tr>
    <tr>
      <th>var95</th>
      <td>0.975280</td>
    </tr>
    <tr>
      <th>var99</th>
      <td>0.959306</td>
    </tr>
    <tr>
      <th>var100</th>
      <td>0.946764</td>
    </tr>
    <tr>
      <th>var101</th>
      <td>0.936186</td>
    </tr>
    <tr>
      <th>costi</th>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">corr_value</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([&#39;var1&#39;, &#39;var2&#39;, &#39;var93&#39;, &#39;var94&#39;, &#39;var95&#39;, &#39;var99&#39;, &#39;var100&#39;,
       &#39;var101&#39;, &#39;costi&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">correlated_data</span> <span class="o">=</span> <span class="n">data2</span><span class="p">[</span><span class="n">corr_value</span><span class="o">.</span><span class="n">index</span><span class="p">]</span>
<span class="n">correlated_data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var1</th>
      <th>var2</th>
      <th>var93</th>
      <th>var94</th>
      <th>var95</th>
      <th>var99</th>
      <th>var100</th>
      <th>var101</th>
      <th>costi</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147823139</td>
      <td>148193655</td>
      <td>145914503</td>
      <td>148992105</td>
      <td>149021406</td>
      <td>85824629</td>
      <td>86758885</td>
      <td>83651116</td>
      <td>144205134</td>
    </tr>
    <tr>
      <th>1</th>
      <td>147562322</td>
      <td>163251010</td>
      <td>142727898</td>
      <td>150222876</td>
      <td>166417107</td>
      <td>102237238</td>
      <td>113037130</td>
      <td>131392006</td>
      <td>140165127</td>
    </tr>
    <tr>
      <th>2</th>
      <td>147562000</td>
      <td>142652000</td>
      <td>148757000</td>
      <td>153783000</td>
      <td>148906000</td>
      <td>117422000</td>
      <td>111227000</td>
      <td>108035000</td>
      <td>145190000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>147067625</td>
      <td>140160124</td>
      <td>119349203</td>
      <td>145528364</td>
      <td>143260149</td>
      <td>105779603</td>
      <td>129982682</td>
      <td>121831610</td>
      <td>112760368</td>
    </tr>
    <tr>
      <th>4</th>
      <td>145273739</td>
      <td>127413305</td>
      <td>174796438</td>
      <td>148011089</td>
      <td>130682792</td>
      <td>149110551</td>
      <td>119058121</td>
      <td>106955719</td>
      <td>171980718</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">correlated_data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>(7479, 9)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">correlated_data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_44_0.png" src="../../_images/regressore_custom_data_44_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">correlated_data</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">annot_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">12</span><span class="p">});</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_45_0.png" src="../../_images/regressore_custom_data_45_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">correlated_data</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">],</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">correlated_data</span><span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">]</span>
<span class="n">X</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>var1</th>
      <th>var2</th>
      <th>var93</th>
      <th>var94</th>
      <th>var95</th>
      <th>var99</th>
      <th>var100</th>
      <th>var101</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>147823139</td>
      <td>148193655</td>
      <td>145914503</td>
      <td>148992105</td>
      <td>149021406</td>
      <td>85824629</td>
      <td>86758885</td>
      <td>83651116</td>
    </tr>
    <tr>
      <th>1</th>
      <td>147562322</td>
      <td>163251010</td>
      <td>142727898</td>
      <td>150222876</td>
      <td>166417107</td>
      <td>102237238</td>
      <td>113037130</td>
      <td>131392006</td>
    </tr>
    <tr>
      <th>2</th>
      <td>147562000</td>
      <td>142652000</td>
      <td>148757000</td>
      <td>153783000</td>
      <td>148906000</td>
      <td>117422000</td>
      <td>111227000</td>
      <td>108035000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>147067625</td>
      <td>140160124</td>
      <td>119349203</td>
      <td>145528364</td>
      <td>143260149</td>
      <td>105779603</td>
      <td>129982682</td>
      <td>121831610</td>
    </tr>
    <tr>
      <th>4</th>
      <td>145273739</td>
      <td>127413305</td>
      <td>174796438</td>
      <td>148011089</td>
      <td>130682792</td>
      <td>149110551</td>
      <td>119058121</td>
      <td>106955719</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>((5983, 8), (1496, 8))
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">fit_intercept</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=True)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">y_predict</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">y_predict</span><span class="p">,</span> <span class="n">y_test</span><span class="p">])</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">T</span>
<span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;costi&#39;</span><span class="p">,</span> <span class="s1">&#39;costi_PRED&#39;</span><span class="p">]</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>costi</th>
      <th>costi_PRED</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.664867e+06</td>
      <td>3534300.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.809564e+06</td>
      <td>7874798.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.152198e+08</td>
      <td>115850068.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.010573e+06</td>
      <td>1048631.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.258395e+06</td>
      <td>3348815.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1491</th>
      <td>9.072874e+06</td>
      <td>9303572.0</td>
    </tr>
    <tr>
      <th>1492</th>
      <td>2.374781e+06</td>
      <td>2310607.0</td>
    </tr>
    <tr>
      <th>1493</th>
      <td>5.624134e+06</td>
      <td>5696533.0</td>
    </tr>
    <tr>
      <th>1494</th>
      <td>5.119308e+06</td>
      <td>5233938.0</td>
    </tr>
    <tr>
      <th>1495</th>
      <td>2.547442e+05</td>
      <td>295468.0</td>
    </tr>
  </tbody>
</table>
<p>1496 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">length</span> <span class="o">=</span> <span class="n">y_predict</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#  </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">length</span><span class="p">,</span><span class="n">length</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_test</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;test&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y_predict</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;predetto&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/regressore_custom_data_52_0.png" src="../../_images/regressore_custom_data_52_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">intercept_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>-27689.42884542793
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coeff</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">coef_</span>
<span class="n">coeff</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([ 0.10767113,  0.3805769 ,  0.93862885, -0.09831021, -0.34587131,
        0.00826232,  0.04751049, -0.04413217])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">(</span><span class="n">correlated_data</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">label</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-none notranslate"><div class="highlight"><pre><span></span>array([&#39;var1&#39;, &#39;var2&#39;, &#39;var93&#39;, &#39;var94&#39;, &#39;var95&#39;, &#39;var99&#39;, &#39;var100&#39;,
       &#39;var101&#39;, &#39;costi&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;coeff&#39;</span><span class="p">:[</span><span class="mf">0.10767113</span><span class="p">,</span>  <span class="mf">0.3805769</span> <span class="p">,</span>  <span class="mf">0.93862885</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.09831021</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.34587131</span><span class="p">,</span><span class="mf">0.00826232</span><span class="p">,</span>  <span class="mf">0.04751049</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.04413217</span><span class="p">],</span>
    <span class="s1">&#39;label&#39;</span><span class="p">:[</span><span class="s1">&#39;var1&#39;</span><span class="p">,</span> <span class="s1">&#39;var2&#39;</span><span class="p">,</span> <span class="s1">&#39;var93&#39;</span><span class="p">,</span> <span class="s1">&#39;var94&#39;</span><span class="p">,</span> <span class="s1">&#39;var95&#39;</span><span class="p">,</span> <span class="s1">&#39;var99&#39;</span><span class="p">,</span> <span class="s1">&#39;var100&#39;</span><span class="p">,</span><span class="s1">&#39;var101&#39;</span><span class="p">]</span> <span class="p">})</span>
<span class="n">export</span><span class="p">[[</span><span class="s1">&#39;coeff&#39;</span><span class="p">,</span><span class="s1">&#39;label&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coeff</th>
      <th>label</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.107671</td>
      <td>var1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.380577</td>
      <td>var2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.938629</td>
      <td>var93</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-0.098310</td>
      <td>var94</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-0.345871</td>
      <td>var95</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.008262</td>
      <td>var99</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.047510</td>
      <td>var100</td>
    </tr>
    <tr>
      <th>7</th>
      <td>-0.044132</td>
      <td>var101</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span><span class="o">.</span><span class="n">to_excel</span><span class="p">(</span><span class="s1">&#39;ridotta.xlsx&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## testare la formua con l&#39;excel di test</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>


              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="boston_housing_dataset.html" title="previous page">Boston Housing Dataset</a>
    <a class='right-next' id="next-link" href="regression_choice.html" title="next page">Regressione: Come Scegliere il modello</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Manuel Rucci / Daniele Grotti<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>